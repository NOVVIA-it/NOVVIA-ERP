<UserControl x:Class="NovviaERP.WPF.Controls.EntitySearchControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <StackPanel>
        <!-- Filter-Zeile (Kunde: Kategorie/Gruppe, Artikel: Warengruppe) -->
        <Grid x:Name="gridFilter" Margin="0,0,0,5" Visibility="Collapsed">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <!-- Kunde Filter -->
            <TextBlock x:Name="lblKategorie" Text="Kategorie:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="cmbKategorie" Grid.Column="1" Margin="0,0,10,0"
                      DisplayMemberPath="CName" SelectedValuePath="KKundenKategorie"/>
            <TextBlock x:Name="lblGruppe" Text="Gruppe:" Grid.Column="2" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="cmbGruppe" Grid.Column="3"
                      DisplayMemberPath="CName" SelectedValuePath="KKundenGruppe"/>
            <!-- Artikel Filter (alternative) -->
            <TextBlock x:Name="lblWarengruppe" Text="Warengruppe:" VerticalAlignment="Center" Margin="0,0,5,0" Visibility="Collapsed"/>
            <ComboBox x:Name="cmbWarengruppe" Grid.Column="1" Grid.ColumnSpan="3"
                      DisplayMemberPath="CName" SelectedValuePath="KWarengruppe" Visibility="Collapsed"/>
        </Grid>

        <!-- Suchzeile -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBox x:Name="txtSuche" Padding="6,5" KeyDown="TxtSuche_KeyDown"
                     VerticalContentAlignment="Center"/>
            <Button x:Name="btnSuche" Grid.Column="1" Content="Suchen" Padding="12,5"
                    Margin="5,0,0,0" Click="Suchen_Click"/>
        </Grid>

        <!-- Ergebnisliste -->
        <Popup x:Name="popupErgebnisse" PlacementTarget="{Binding ElementName=txtSuche}"
               Placement="Bottom" StaysOpen="False" AllowsTransparency="True">
            <Border Background="White" BorderBrush="#ccc" BorderThickness="1"
                    MaxHeight="250" MinWidth="{Binding ActualWidth, ElementName=txtSuche}">
                <ListBox x:Name="lstErgebnisse" BorderThickness="0"
                         MouseDoubleClick="LstErgebnisse_DoubleClick"
                         KeyDown="LstErgebnisse_KeyDown">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="5,3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{Binding Nr}" FontWeight="SemiBold"/>
                                <TextBlock Grid.Column="1" Text="{Binding Name}" Foreground="#333"
                                           TextTrimming="CharacterEllipsis"/>
                                <TextBlock Grid.Column="2" Text="{Binding Extra}" Foreground="#888" FontSize="11"
                                           Margin="10,0,0,0"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Border>
        </Popup>
    </StackPanel>
</UserControl>

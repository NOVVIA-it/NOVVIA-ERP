<UserControl x:Class="NovviaERP.WPF.Views.WorkflowPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:NovviaERP.WPF.Views"
             Background="{DynamicResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="180"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{DynamicResource HeaderBrush}" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="JTL Workflows" FontSize="24" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Automatisierte Aktionen bei Ereignissen (ausgefuehrt durch JTL-Wawi Worker)" FontSize="12" Foreground="#B0B0B0" Margin="0,5,0,0"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="+ Neuer Workflow" Click="NeuerJtlWorkflow_Click"
                            Background="#4CAF50" Foreground="White" Padding="15,8" Margin="5,0"
                            BorderThickness="0" Cursor="Hand"/>
                    <Button Content="Aktualisieren" Click="Aktualisieren_Click"
                            Background="#2196F3" Foreground="White" Padding="15,8" Margin="5,0"
                            BorderThickness="0" Cursor="Hand"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Toolbar -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="20,15,20,10">
            <Button x:Name="btnJtlBearbeiten" Content="Bearbeiten" Click="JtlWorkflowBearbeiten_Click"
                    Padding="12,6" Margin="0,0,10,0" IsEnabled="False"/>
            <Button x:Name="btnJtlLoeschen" Content="Loeschen" Click="JtlWorkflowLoeschen_Click"
                    Padding="12,6" Margin="0,0,20,0" IsEnabled="False" Background="#f44336" Foreground="White" BorderThickness="0"/>
            <TextBlock Text="Objekt:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <ComboBox x:Name="cmbJtlObjektFilter" Width="150" SelectionChanged="JtlFilter_Changed">
                <ComboBoxItem Content="Alle" IsSelected="True" Tag=""/>
                <ComboBoxItem Content="Kunde" Tag="5"/>
                <ComboBoxItem Content="Auftrag" Tag="6"/>
                <ComboBoxItem Content="Lieferschein" Tag="7"/>
                <ComboBoxItem Content="Rechnung" Tag="8"/>
            </ComboBox>
        </StackPanel>

        <!-- Workflow Liste -->
        <DataGrid x:Name="dgJtlWorkflows" Grid.Row="2" Margin="20,0" AutoGenerateColumns="False" IsReadOnly="True"
                  SelectionChanged="JtlWorkflow_SelectionChanged" MouseDoubleClick="JtlWorkflow_DoubleClick">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding KWorkflow}" Width="50"/>
                <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="250"/>
                <DataGridTextColumn Header="Event" Binding="{Binding EventName}" Width="200"/>
                <DataGridTextColumn Header="Objekt" Binding="{Binding ObjektName}" Width="100"/>
                <DataGridTextColumn Header="Typ" Binding="{Binding TypName}" Width="100"/>
                <DataGridTextColumn Header="Aktionen" Binding="{Binding AktionenCount}" Width="70"/>
                <DataGridTextColumn Header="Bedingungen" Binding="{Binding BedingungenCount}" Width="90"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Details Header -->
        <TextBlock Grid.Row="3" Text="Aktionen und Bedingungen:" FontWeight="Bold" Margin="20,15,20,8"/>

        <!-- Aktionen/Bedingungen Detail -->
        <Grid Grid.Row="4" Margin="20,0,20,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Aktionen -->
            <GroupBox Header="Aktionen" Margin="0,0,10,0">
                <DataGrid x:Name="dgJtlAktionen" AutoGenerateColumns="False" IsReadOnly="True" HeadersVisibility="Column">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Pos" Binding="{Binding NPos}" Width="40"/>
                        <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="*"/>
                        <DataGridTextColumn Header="Typ" Binding="{Binding AktionTyp}" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>

            <!-- Bedingungen -->
            <GroupBox Grid.Column="1" Header="Bedingungen" Margin="10,0,0,0">
                <DataGrid x:Name="dgJtlBedingungen" AutoGenerateColumns="False" IsReadOnly="True" HeadersVisibility="Column">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Pos" Binding="{Binding NPos}" Width="40"/>
                        <DataGridTextColumn Header="Eigenschaft" Binding="{Binding Eigenschaft}" Width="*"/>
                        <DataGridTextColumn Header="Op" Binding="{Binding OperatorText}" Width="50"/>
                        <DataGridTextColumn Header="Wert" Binding="{Binding CVergleichswert}" Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>
        </Grid>
    </Grid>
</UserControl>

<Page x:Class="NovviaERP.WPF.Views.BestellungDetailPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Auftrag" Background="#f5f5f5">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Background="White" BorderBrush="#ddd" BorderThickness="0,0,0,1" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Button Content="Zurueck" Click="Zurueck_Click" Padding="10,5" VerticalAlignment="Center"/>
                <StackPanel Grid.Column="1" Margin="20,0,0,0" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="txtTitel" Text="Auftrag" FontSize="20" FontWeight="SemiBold"/>
                        <Border x:Name="brdStatus" Background="#28a745" CornerRadius="3" Padding="8,2" Margin="15,0,0,0" VerticalAlignment="Center">
                            <TextBlock x:Name="txtStatusBadge" Text="Offen" Foreground="White" FontSize="11"/>
                        </Border>
                    </StackPanel>
                    <TextBlock x:Name="txtSubtitel" Text="" FontSize="12" Foreground="#666"/>
                </StackPanel>
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock x:Name="txtBestellNr" Text="" FontSize="18" Foreground="#0078D4"
                               FontWeight="SemiBold" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Content -->
        <TabControl Grid.Row="1" Margin="20,15,20,0">

            <!-- Tab: Uebersicht -->
            <TabItem Header="Uebersicht">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Linke Spalte: Auftragsdaten -->
                        <StackPanel>
                            <TextBlock Text="Auftragsdaten" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,15"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="130"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Bestellnummer:" VerticalAlignment="Center"/>
                                <TextBlock x:Name="txtBestellNrDetail" Grid.Column="1" VerticalAlignment="Center" FontWeight="SemiBold"/>

                                <TextBlock Text="Externe Nr.:" Grid.Row="1" VerticalAlignment="Center"/>
                                <TextBlock x:Name="txtExterneNr" Grid.Row="1" Grid.Column="1" VerticalAlignment="Center"/>

                                <TextBlock Text="Datum:" Grid.Row="2" VerticalAlignment="Center"/>
                                <TextBlock x:Name="txtDatum" Grid.Row="2" Grid.Column="1" VerticalAlignment="Center"/>

                                <TextBlock Text="Status:" Grid.Row="3" VerticalAlignment="Center"/>
                                <ComboBox x:Name="cmbStatus" Grid.Row="3" Grid.Column="1" Width="150" HorizontalAlignment="Left" Height="26">
                                    <ComboBoxItem Content="Offen" Tag="Offen"/>
                                    <ComboBoxItem Content="In Bearbeitung" Tag="In Bearbeitung"/>
                                    <ComboBoxItem Content="Bezahlt" Tag="Bezahlt"/>
                                    <ComboBoxItem Content="Versendet" Tag="Versendet"/>
                                    <ComboBoxItem Content="Storniert" Tag="Storniert"/>
                                </ComboBox>

                                <TextBlock Text="Shop:" Grid.Row="4" VerticalAlignment="Center"/>
                                <TextBlock x:Name="txtShop" Grid.Row="4" Grid.Column="1" VerticalAlignment="Center"/>
                            </Grid>
                        </StackPanel>

                        <!-- Rechte Spalte: Kunde -->
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Kunde" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,15"/>
                            <Border Background="#f8f8f8" BorderBrush="#ddd" BorderThickness="1" Padding="15" CornerRadius="4">
                                <StackPanel>
                                    <TextBlock x:Name="txtKundeFirma" FontWeight="SemiBold" FontSize="14"/>
                                    <TextBlock x:Name="txtKundeName" Margin="0,3,0,0"/>
                                    <TextBlock x:Name="txtKundeNr" Foreground="#0078D4" Margin="0,8,0,0"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                        <TextBlock Text="Tel: " Foreground="#666"/>
                                        <TextBlock x:Name="txtKundeTel"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <TextBlock Text="Mail: " Foreground="#666"/>
                                        <TextBlock x:Name="txtKundeMail" Foreground="#0078D4"/>
                                    </StackPanel>
                                    <Button Content="Kunde oeffnen" Click="KundeOeffnen_Click" Margin="0,10,0,0"
                                            HorizontalAlignment="Left" Padding="10,3"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Zweite Zeile: Adressen -->
                        <Grid Grid.Row="1" Grid.ColumnSpan="3" Margin="0,25,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Rechnungsadresse -->
                            <StackPanel>
                                <TextBlock Text="Rechnungsadresse" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10"/>
                                <Border Background="#fff" BorderBrush="#ddd" BorderThickness="1" Padding="15" CornerRadius="4">
                                    <TextBlock x:Name="txtRechnungsadresse" TextWrapping="Wrap"/>
                                </Border>
                            </StackPanel>

                            <!-- Lieferadresse -->
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Lieferadresse" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10"/>
                                <Border Background="#fff" BorderBrush="#ddd" BorderThickness="1" Padding="15" CornerRadius="4">
                                    <TextBlock x:Name="txtLieferadresse" TextWrapping="Wrap"/>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- Tab: Positionen -->
            <TabItem Header="Positionen">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <DataGrid x:Name="dgPositionen" AutoGenerateColumns="False" IsReadOnly="True"
                              HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                              RowBackground="White" AlternatingRowBackground="#fafafa">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Art-Nr." Binding="{Binding CArtNr}" Width="100"/>
                            <DataGridTextColumn Header="Bezeichnung" Binding="{Binding CName}" Width="*"/>
                            <DataGridTextColumn Header="Menge" Binding="{Binding FAnzahl, StringFormat=N0}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Einheit" Binding="{Binding CEinheit}" Width="60"/>
                            <DataGridTextColumn Header="Einzelpreis" Binding="{Binding FVKBrutto, StringFormat=N2}" Width="90">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="MwSt %" Binding="{Binding FMwSt, StringFormat=N0}" Width="60">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Summe" Binding="{Binding Summe, StringFormat=N2}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Summen -->
                    <Border Grid.Row="1" Background="#f8f8f8" Padding="15" Margin="0,15,0,0" CornerRadius="4">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="120"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25"/>
                                <RowDefinition Height="25"/>
                                <RowDefinition Height="25"/>
                                <RowDefinition Height="30"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Zwischensumme Netto:" Grid.Column="1" VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtSummeNetto" Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right"/>

                            <TextBlock Text="Versandkosten:" Grid.Row="1" Grid.Column="1" VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtVersandkosten" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right"/>

                            <TextBlock Text="MwSt:" Grid.Row="2" Grid.Column="1" VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtMwSt" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right"/>

                            <TextBlock Text="Gesamtbetrag:" Grid.Row="3" Grid.Column="1" VerticalAlignment="Center" FontWeight="Bold" FontSize="14"/>
                            <TextBlock x:Name="txtGesamtBrutto" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right"
                                       FontWeight="Bold" FontSize="16" Foreground="#0078D4"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Tab: Versand -->
            <TabItem Header="Versand">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <TextBlock Text="Versandinformationen" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="35"/>
                                <RowDefinition Height="35"/>
                                <RowDefinition Height="35"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Versandart:" VerticalAlignment="Center"/>
                            <ComboBox x:Name="cmbVersandart" Grid.Column="1" Height="28"
                                      DisplayMemberPath="CName" SelectedValuePath="KVersandArt"/>

                            <TextBlock Text="Sendungsnummer:" Grid.Row="1" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtSendungsnummer" Grid.Row="1" Grid.Column="1" Height="28"/>

                            <TextBlock Text="Versanddatum:" Grid.Row="2" VerticalAlignment="Center"/>
                            <DatePicker x:Name="dpVersanddatum" Grid.Row="2" Grid.Column="1" Width="150" HorizontalAlignment="Left"/>
                        </Grid>

                        <Button x:Name="btnAlsVersendetMarkieren" Content="Als versendet markieren"
                                Click="AlsVersendetMarkieren_Click" Margin="0,20,0,0"
                                Padding="15,8" Background="#28a745" Foreground="White" BorderThickness="0"
                                HorizontalAlignment="Left"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab: Zahlung -->
            <TabItem Header="Zahlung">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <TextBlock Text="Zahlungsinformationen" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="35"/>
                                <RowDefinition Height="35"/>
                                <RowDefinition Height="35"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Zahlungsart:" VerticalAlignment="Center"/>
                            <ComboBox x:Name="cmbZahlungsart" Grid.Column="1" Height="28"
                                      DisplayMemberPath="CName" SelectedValuePath="KZahlungsart"/>

                            <TextBlock Text="Zahlungsziel:" Grid.Row="1" VerticalAlignment="Center"/>
                            <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                                <TextBox x:Name="txtZahlungsziel" Width="60" Height="28"/>
                                <TextBlock Text="Tage" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>

                            <TextBlock Text="Bezahlt am:" Grid.Row="2" VerticalAlignment="Center"/>
                            <DatePicker x:Name="dpBezahltAm" Grid.Row="2" Grid.Column="1" Width="150" HorizontalAlignment="Left"/>
                        </Grid>

                        <Button x:Name="btnAlsBezahltMarkieren" Content="Als bezahlt markieren"
                                Click="AlsBezahltMarkieren_Click" Margin="0,20,0,0"
                                Padding="15,8" Background="#0078D4" Foreground="White" BorderThickness="0"
                                HorizontalAlignment="Left"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab: Anmerkungen -->
            <TabItem Header="Anmerkungen">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Interne Anmerkungen" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10"/>
                    <TextBox x:Name="txtAnmerkungen" Grid.Row="1" AcceptsReturn="True" TextWrapping="Wrap"
                             VerticalScrollBarVisibility="Auto"/>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Footer -->
        <Border Grid.Row="2" Background="White" BorderBrush="#ddd" BorderThickness="0,1,0,0" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="txtStatus" Text="" Foreground="#666" VerticalAlignment="Center"/>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Lieferschein" Click="Lieferschein_Click" Padding="12,8" Margin="0,0,10,0"/>
                    <Button Content="Rechnung" Click="Rechnung_Click" Padding="12,8" Margin="0,0,10,0"/>
                    <Button Content="Abbrechen" Click="Zurueck_Click" Padding="15,8" Margin="0,0,10,0"/>
                    <Button Content="Speichern" Click="Speichern_Click" Padding="15,8"
                            Background="#0078D4" Foreground="White" BorderThickness="0"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>

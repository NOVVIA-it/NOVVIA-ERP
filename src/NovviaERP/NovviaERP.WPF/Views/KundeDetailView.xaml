<UserControl x:Class="NovviaERP.WPF.Views.KundeDetailView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:controls="clr-namespace:NovviaERP.WPF.Controls"
             Background="#f5f5f5">
    <DockPanel LastChildFill="True">
        <!-- Footer ZUERST (DockPanel.Dock=Bottom) damit er immer sichtbar ist -->
        <Border DockPanel.Dock="Bottom" Background="White" BorderBrush="#ddd" BorderThickness="0,1,0,0" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="txtStatus" Foreground="#666" VerticalAlignment="Center"/>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="💾 Speichern" Click="Speichern_Click" Padding="15,8" Margin="0,0,8,0"
                            Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0"/>
                    <Button Content="❌ Abbrechen" Click="Zurueck_Click" Padding="12,8"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Rest des Inhalts -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

        <!-- Header -->
        <Border Background="{DynamicResource PrimaryBrush}" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Button Content="Zurück" Click="Zurueck_Click" Padding="10,5" VerticalAlignment="Center"
                        Background="White" Foreground="#333"/>
                <StackPanel Grid.Column="1" Margin="20,0,0,0" VerticalAlignment="Center">
                    <TextBlock x:Name="txtTitel" Text="Kunde" FontSize="18" FontWeight="SemiBold" Foreground="White"/>
                    <TextBlock Text="Hier koennen Sie die Stammdaten Ihres Kunden erfassen und pflegen."
                               FontSize="11" Foreground="#cce5ff" Margin="0,2,0,0"/>
                </StackPanel>
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock x:Name="txtKundenNrHeader" Foreground="White" VerticalAlignment="Center" Margin="0,0,10,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Textmeldungen -->
        <controls:TextmeldungPanel x:Name="pnlTextmeldungen" Grid.Row="1" Margin="10,10,10,0"/>

        <!-- Main Content -->
        <TabControl Grid.Row="2" Margin="10,10,10,5">
            <!-- Tab: Kundendaten -->
            <TabItem Header="👤 Kundendaten">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="180"/>
                    </Grid.RowDefinitions>

                    <!-- Linke Spalte: Allgemeine Infos + Kundendaten -->
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="5">
                        <StackPanel>
                            <!-- Allgemeine Informationen -->
                            <GroupBox Header="Allgemeine Informationen" Margin="0,0,0,10">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="110"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="110"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Text="Kundennummer:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtKundenNr" Grid.Column="1" IsReadOnly="True" Background="#f8f8f8"/>
                                    <TextBlock Text="Debitorennr.:" Grid.Column="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtDebitorenNr" Grid.Column="4" IsReadOnly="True" Background="#f8f8f8"/>
                                </Grid>
                            </GroupBox>

                            <!-- Kundendaten -->
                            <GroupBox Header="Kundendaten" Margin="0,0,0,10">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="90"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="8"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>

                                    <!-- Linke Seite -->
                                    <TextBlock Text="Firma:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtFirma" Grid.Column="1" Grid.ColumnSpan="4"/>

                                    <TextBlock Text="Firmenzusatz:" Grid.Row="1" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtFirmenzusatz" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="4"/>

                                    <TextBlock Text="Anrede:" Grid.Row="2" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cmbAnrede" Grid.Row="2" Grid.Column="1" Width="80" HorizontalAlignment="Left">
                                        <ComboBoxItem Content=""/>
                                        <ComboBoxItem Content="Herr"/>
                                        <ComboBoxItem Content="Frau"/>
                                        <ComboBoxItem Content="Firma"/>
                                    </ComboBox>
                                    <TextBlock Text="Titel:" Grid.Row="2" Grid.Column="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtTitel2" Grid.Row="2" Grid.Column="4"/>

                                    <TextBlock Text="Vorname:" Grid.Row="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtVorname" Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="4"/>

                                    <TextBlock Text="Nachname:" Grid.Row="4" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtNachname" Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="4"/>

                                    <!-- Separator -->
                                    <TextBlock Text="Strasse/Nr.:" Grid.Row="7" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtStrasse" Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="4"/>

                                    <TextBlock Text="Adresszusatz:" Grid.Row="8" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtAdresszusatz" Grid.Row="8" Grid.Column="1" Grid.ColumnSpan="4"/>

                                    <TextBlock Text="PLZ:" Grid.Row="9" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtPLZ" Grid.Row="9" Grid.Column="1" Width="60" HorizontalAlignment="Left"/>
                                    <TextBlock Text="Ort:" Grid.Row="9" Grid.Column="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtOrt" Grid.Row="9" Grid.Column="4"/>

                                    <TextBlock Text="Land:" Grid.Row="10" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cmbLand" Grid.Row="10" Grid.Column="1" Grid.ColumnSpan="4"/>
                                </Grid>
                            </GroupBox>

                            <!-- Kontaktdaten -->
                            <GroupBox Header="Kontaktdaten" Margin="0,0,0,10">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="90"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Text="E-Mail:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtEmail" Grid.Column="1" Grid.ColumnSpan="4"/>

                                    <TextBlock Text="Telefon:" Grid.Row="1" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtTelefon" Grid.Row="1" Grid.Column="1"/>
                                    <TextBlock Text="Mobil:" Grid.Row="1" Grid.Column="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtMobil" Grid.Row="1" Grid.Column="4"/>

                                    <TextBlock Text="Fax:" Grid.Row="2" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtFax" Grid.Row="2" Grid.Column="1"/>
                                    <TextBlock Text="Webseite:" Grid.Row="2" Grid.Column="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtWebseite" Grid.Row="2" Grid.Column="4"/>

                                    <TextBlock Text="Steuernr.:" Grid.Row="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtSteuernr" Grid.Row="3" Grid.Column="1"/>
                                    <TextBlock Text="USt-IdNr.:" Grid.Row="3" Grid.Column="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtUstId" Grid.Row="3" Grid.Column="4"/>
                                </Grid>
                            </GroupBox>

                            <!-- Tabs: Adressen, Ansprechpartner, Bankverbindungen, Onlineshop -->
                            <TabControl Height="220">
                                <TabItem Header="📍 Adressen">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <DataGrid x:Name="dgAdressen" AutoGenerateColumns="False" IsReadOnly="True"
                                                  CanUserAddRows="False" HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Typ" Binding="{Binding AdressTypText}" Width="100"/>
                                                <DataGridCheckBoxColumn Header="Standard" Binding="{Binding IstStandard, Mode=OneWay}" Width="60" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Vorname" Binding="{Binding CVorname}" Width="80"/>
                                                <DataGridTextColumn Header="Nachname" Binding="{Binding CName}" Width="100"/>
                                                <DataGridTextColumn Header="Strasse" Binding="{Binding CStrasse}" Width="150"/>
                                                <DataGridTextColumn Header="Ort" Binding="{Binding COrt}" Width="100"/>
                                                <DataGridTextColumn Header="E-Mail" Binding="{Binding CMail}" Width="150"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                                            <Button Content="Hinzufuegen" Padding="8,4" Margin="0,0,5,0" Click="AdresseHinzufuegen_Click"/>
                                            <Button Content="Bearbeiten" Padding="8,4" Margin="0,0,5,0" Click="AdresseBearbeiten_Click"/>
                                            <Button Content="Loeschen" Padding="8,4" Click="AdresseLoeschen_Click"/>
                                        </StackPanel>
                                    </Grid>
                                </TabItem>
                                <TabItem Header="👥 Ansprechpartner">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <DataGrid x:Name="dgAnsprechpartner" AutoGenerateColumns="False" IsReadOnly="True"
                                                  CanUserAddRows="False" HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Anrede" Binding="{Binding CAnrede}" Width="60"/>
                                                <DataGridTextColumn Header="Vorname" Binding="{Binding CVorname}" Width="80"/>
                                                <DataGridTextColumn Header="Nachname" Binding="{Binding CName}" Width="100"/>
                                                <DataGridTextColumn Header="Abteilung" Binding="{Binding CAbteilung}" Width="100"/>
                                                <DataGridTextColumn Header="Telefon" Binding="{Binding CTel}" Width="100"/>
                                                <DataGridTextColumn Header="E-Mail" Binding="{Binding CMail}" Width="150"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                                            <Button Content="Hinzufuegen" Padding="8,4" Margin="0,0,5,0" Click="AnsprechpartnerHinzufuegen_Click"/>
                                            <Button Content="Bearbeiten" Padding="8,4" Margin="0,0,5,0" Click="AnsprechpartnerBearbeiten_Click"/>
                                            <Button Content="Loeschen" Padding="8,4" Click="AnsprechpartnerLoeschen_Click"/>
                                        </StackPanel>
                                    </Grid>
                                </TabItem>
                                <TabItem Header="🏦 Bankverbindungen">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <DataGrid x:Name="dgBankverbindungen" AutoGenerateColumns="False" IsReadOnly="True"
                                                  CanUserAddRows="False" HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridCheckBoxColumn Header="Standard" Binding="{Binding IstStandard, Mode=OneWay}" Width="60" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Bankname" Binding="{Binding CBankName}" Width="150"/>
                                                <DataGridTextColumn Header="Inhaber" Binding="{Binding CInhaber}" Width="120"/>
                                                <DataGridTextColumn Header="IBAN" Binding="{Binding CIBAN}" Width="180"/>
                                                <DataGridTextColumn Header="BIC" Binding="{Binding CBIC}" Width="100"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                                            <Button Content="Hinzufuegen" Padding="8,4" Margin="0,0,5,0" Click="BankverbindungHinzufuegen_Click"/>
                                            <Button Content="Bearbeiten" Padding="8,4" Margin="0,0,5,0" Click="BankverbindungBearbeiten_Click"/>
                                            <Button Content="Loeschen" Padding="8,4" Click="BankverbindungLoeschen_Click"/>
                                        </StackPanel>
                                    </Grid>
                                </TabItem>
                                <TabItem Header="🛒 Onlineshop">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <DataGrid x:Name="dgOnlineshop" AutoGenerateColumns="False" IsReadOnly="True"
                                                  CanUserAddRows="False" HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Shop" Binding="{Binding ShopName}" Width="120"/>
                                                <DataGridTextColumn Header="Benutzername" Binding="{Binding CBenutzername}" Width="120"/>
                                                <DataGridTextColumn Header="E-Mail" Binding="{Binding CMail}" Width="150"/>
                                                <DataGridCheckBoxColumn Header="Aktiv" Binding="{Binding IstAktiv}" Width="50"/>
                                                <DataGridTextColumn Header="Rabatt" Binding="{Binding FRabatt, StringFormat=N2}" Width="60"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                        <TextBlock Grid.Row="1" Text="Onlineshop-Kunden werden automatisch verknuepft"
                                                   FontSize="11" Foreground="#666" Margin="5"/>
                                    </Grid>
                                </TabItem>
                            </TabControl>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Rechte Spalte: Interne Daten + Zahlungen -->
                    <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" Margin="5">
                        <StackPanel>
                            <!-- Interne Daten -->
                            <GroupBox Header="Interne Daten" Margin="0,0,0,10">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>

                                    <CheckBox x:Name="chkKassenkunde" Content="Kassenkunde" Grid.ColumnSpan="2"/>
                                    <CheckBox x:Name="chkGesperrt" Content="Gesperrt" Grid.Row="0" Grid.Column="1" HorizontalAlignment="Right"/>

                                    <TextBlock Text="Kunde seit:" Grid.Row="1" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtKundeSeit" Grid.Row="1" Grid.Column="1" IsReadOnly="True" Background="#f8f8f8"/>

                                    <TextBlock Text="Kundengruppe:" Grid.Row="2" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cmbKundengruppe" Grid.Row="2" Grid.Column="1"/>

                                    <TextBlock Text="Kundenkategorie:" Grid.Row="3" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cmbKundenkategorie" Grid.Row="3" Grid.Column="1"/>

                                    <TextBlock Text="Herkunft:" Grid.Row="4" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtHerkunft" Grid.Row="4" Grid.Column="1"/>

                                    <TextBlock Text="Sprache:" Grid.Row="5" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cmbSprache" Grid.Row="5" Grid.Column="1">
                                        <ComboBoxItem Content="Deutsch" IsSelected="True"/>
                                        <ComboBoxItem Content="Englisch"/>
                                    </ComboBox>
                                </Grid>
                            </GroupBox>

                            <!-- Zahlungen -->
                            <GroupBox Header="Zahlungen" Margin="0,0,0,10">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>

                                    <CheckBox x:Name="chkMahnstopp" Content="Mahnstopp" Grid.ColumnSpan="4"/>

                                    <TextBlock Text="Zahlungsziel:" Grid.Row="1" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtZahlungsziel" Grid.Row="1" Grid.Column="1" Width="60" HorizontalAlignment="Left"/>
                                    <TextBlock Text="Rabatt (%):" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtRabatt" Grid.Row="1" Grid.Column="3"/>

                                    <TextBlock Text="Zahlungsart:" Grid.Row="2" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cmbZahlungsart" Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3"/>

                                    <TextBlock Text="Kreditlimit:" Grid.Row="3" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtKreditlimit" Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3"/>
                                </Grid>
                            </GroupBox>

                            <!-- Statistik -->
                            <GroupBox Header="Statistik" Margin="0,0,0,10">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="26"/>
                                        <RowDefinition Height="26"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Text="Bestellungen:" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtAnzahlBestellungen" Grid.Column="1" VerticalAlignment="Center" FontWeight="SemiBold"/>

                                    <TextBlock Text="Umsatz:" Grid.Row="1" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtGesamtUmsatz" Grid.Row="1" Grid.Column="1" VerticalAlignment="Center"
                                               FontWeight="SemiBold" Foreground="#28a745"/>
                                </Grid>
                            </GroupBox>

                            <!-- Eigene Felder Expander -->
                            <Expander Header="Eigene Felder" IsExpanded="False" Margin="0,0,0,10">
                                <DataGrid x:Name="dgEigeneFelder" AutoGenerateColumns="False" Height="150"
                                          CanUserAddRows="False" HeadersVisibility="Column">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Feldname" Binding="{Binding FeldName}" Width="120" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Wert" Binding="{Binding Wert}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Unterer Bereich: Auftraege, Rechnungen, Gutschriften -->
                    <Border Grid.Row="1" Grid.ColumnSpan="2" Background="White" BorderBrush="#ddd" BorderThickness="1" Margin="5,0,5,5">
                        <TabControl x:Name="tcKundenDaten" BorderThickness="0">
                            <!-- Tab: Auftraege -->
                            <TabItem Header="📦 Aufträge">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <DataGrid x:Name="dgAuftraege" AutoGenerateColumns="False" IsReadOnly="True"
                                              CanUserAddRows="False" HeadersVisibility="Column" FontSize="11"
                                              SelectionMode="Single" SelectionUnit="FullRow">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Header="Nr." Width="70">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding CAuftragsNr}" Foreground="#0066CC" Cursor="Hand"
                                                                   TextDecorations="Underline" MouseLeftButtonUp="AuftragNr_Click"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Header="Datum" Binding="{Binding DErstellt, StringFormat=dd.MM.yy}" Width="60"/>
                                            <DataGridTextColumn Header="Status" Binding="{Binding StatusText}" Width="60"/>
                                            <DataGridTextColumn Header="Netto" Binding="{Binding FGesamtNetto, StringFormat=N2}" Width="70">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <TextBlock x:Name="txtAuftraegeAnzahl" Text="0 Auftraege" FontSize="10" Foreground="#666" Margin="5"/>
                                </Grid>
                            </TabItem>
                            <!-- Tab: Rechnungen -->
                            <TabItem Header="🧾 Rechnungen">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <DataGrid x:Name="dgRechnungen" AutoGenerateColumns="False" IsReadOnly="True"
                                              CanUserAddRows="False" HeadersVisibility="Column" FontSize="11"
                                              SelectionMode="Single" SelectionUnit="FullRow">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Header="Nr." Width="70">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding CRechnungsNr}" Foreground="#0066CC" Cursor="Hand"
                                                                   TextDecorations="Underline" MouseLeftButtonUp="RechnungNr_Click"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Header="Datum" Binding="{Binding DErstellt, StringFormat=dd.MM.yy}" Width="60"/>
                                            <DataGridTextColumn Header="Status" Binding="{Binding StatusText}" Width="60"/>
                                            <DataGridTextColumn Header="Brutto" Binding="{Binding FGesamtBrutto, StringFormat=N2}" Width="70">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <TextBlock x:Name="txtRechnungenAnzahl" Text="0 Rechnungen" FontSize="10" Foreground="#666" Margin="5"/>
                                </Grid>
                            </TabItem>
                            <!-- Tab: Gutschriften -->
                            <TabItem Header="💸 Gutschriften">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <DataGrid x:Name="dgGutschriften" AutoGenerateColumns="False" IsReadOnly="True"
                                              CanUserAddRows="False" HeadersVisibility="Column" FontSize="11">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Nr." Binding="{Binding CGutschriftNr}" Width="70"/>
                                            <DataGridTextColumn Header="Datum" Binding="{Binding DErstellt, StringFormat=dd.MM.yy}" Width="60"/>
                                            <DataGridTextColumn Header="Brutto" Binding="{Binding FGesamtBrutto, StringFormat=N2}" Width="70">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5" HorizontalAlignment="Right">
                                        <TextBlock x:Name="txtGutschriftenAnzahl" Text="0 Gutschriften" FontSize="10" Foreground="#666" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </TabItem>
                        </TabControl>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Tab: Eigene Felder / Validierung -->
            <TabItem Header="📝 Eigene Felder">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel MaxWidth="500" HorizontalAlignment="Left">
                        <GroupBox Header="Validierung (Pharma)" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <CheckBox x:Name="chkValAmbient" Content="Ambient" Margin="0,5,0,10"/>
                                <CheckBox x:Name="chkValCool" Content="Cool" Margin="0,0,0,10"/>
                                <CheckBox x:Name="chkValMedcan" Content="Medcan" Margin="0,0,0,10"/>
                                <CheckBox x:Name="chkValTierarznei" Content="Tierarznei" Margin="0,0,0,5"/>
                            </StackPanel>
                        </GroupBox>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="35"/>
                                <RowDefinition Height="35"/>
                                <RowDefinition Height="35"/>
                                <RowDefinition Height="35"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Qualifiziert am:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="dpQualifiziertAm" Grid.Column="1"/>

                            <TextBlock Text="Qualifiziert von:" Grid.Row="1" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtQualifiziertVon" Grid.Row="1" Grid.Column="1"/>

                            <TextBlock Text="GDP:" Grid.Row="2" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtGDP" Grid.Row="2" Grid.Column="1"/>

                            <TextBlock Text="GMP:" Grid.Row="3" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtGMP" Grid.Row="3" Grid.Column="1"/>
                        </Grid>

                        <Button Content="Validierung speichern" Click="ValidierungSpeichern_Click"
                                Padding="15,8" HorizontalAlignment="Left" Margin="0,20,0,0"
                                Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab: Textmeldungen -->
            <TabItem Header="💬 Textmeldungen">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Textmeldungen fuer diesen Kunden" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>

                    <DataGrid x:Name="dgTextmeldungen" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              BorderThickness="1" BorderBrush="#ddd">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding NTyp}" Value="0">
                                        <Setter Property="Background" Value="#E3F2FD"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding NTyp}" Value="1">
                                        <Setter Property="Background" Value="#FFF8E1"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding NTyp}" Value="2">
                                        <Setter Property="Background" Value="#FFEBEE"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Typ" Binding="{Binding NTyp}" Width="50">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding NTyp}" Value="0">
                                                <Setter Property="Text" Value="Info"/>
                                                <Setter Property="Foreground" Value="#1976D2"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NTyp}" Value="1">
                                                <Setter Property="Text" Value="Warn"/>
                                                <Setter Property="Foreground" Value="#F57C00"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NTyp}" Value="2">
                                                <Setter Property="Text" Value="Wichtig"/>
                                                <Setter Property="Foreground" Value="#D32F2F"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Titel" Binding="{Binding CTitel}" Width="150"/>
                            <DataGridTextColumn Header="Text" Binding="{Binding CText}" Width="*"/>
                            <DataGridCheckBoxColumn Header="Popup" Binding="{Binding NPopupAnzeigen}" Width="60"/>
                            <DataGridTextColumn Header="Erstellt" Binding="{Binding DErstellt, StringFormat=dd.MM.yyyy}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Neue Textmeldung" Click="BtnNeueTextmeldung_Click" Padding="15,8"
                                Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="Bearbeiten" Click="BtnTextmeldungBearbeiten_Click" Padding="15,8" Margin="0,0,10,0"/>
                        <Button Content="Loeschen" Click="BtnTextmeldungLoeschen_Click" Padding="15,8" Foreground="#D32F2F"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
        </Grid>
    </DockPanel>
</UserControl>

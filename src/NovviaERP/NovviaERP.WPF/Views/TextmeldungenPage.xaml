<UserControl x:Class="NovviaERP.WPF.Views.TextmeldungenPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#f0f2f5">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Background="White" BorderBrush="#ddd" BorderThickness="0,0,0,1" Padding="15,12">
            <TextBlock Text="Textmeldungen verwalten" FontSize="22" FontWeight="SemiBold"/>
        </Border>

        <!-- Aktionsleiste -->
        <Border Grid.Row="1" Background="#f8f9fa" Padding="15,10" BorderBrush="#ddd" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal">
                <Button Content="+ Neue Meldung" Click="TextmeldungNeu_Click" Padding="15,8"
                        Background="#0078D4" Foreground="White" BorderThickness="0" FontWeight="SemiBold" FontSize="13"/>
                <Button x:Name="btnBearbeiten" Content="Bearbeiten" Click="TextmeldungBearbeiten_Click"
                        Padding="12,8" Margin="10,0,0,0" IsEnabled="False"/>
                <Button x:Name="btnLoeschen" Content="Loeschen" Click="TextmeldungLoeschen_Click"
                        Padding="12,8" Margin="5,0,0,0" IsEnabled="False"/>
            </StackPanel>
        </Border>

        <!-- Meldungsliste -->
        <Border Grid.Row="2" Background="White" Margin="15">
            <ListBox x:Name="lstTextmeldungen" BorderThickness="1" BorderBrush="#ddd"
                     SelectionChanged="LstTextmeldungen_SelectionChanged"
                     MouseDoubleClick="LstTextmeldungen_DoubleClick">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border Padding="12,10" BorderBrush="#eee" BorderThickness="0,0,0,1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Typ-Indikator -->
                                <Border Width="8" Height="8" CornerRadius="4" VerticalAlignment="Top" Margin="0,5,12,0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#2196F3"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding NTyp}" Value="1">
                                                    <Setter Property="Background" Value="#FF9800"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding NTyp}" Value="2">
                                                    <Setter Property="Background" Value="#f44336"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                </Border>

                                <!-- Inhalt -->
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="{Binding CTitel}" FontWeight="SemiBold" FontSize="14"/>
                                    <TextBlock Text="{Binding CText}" Foreground="#555" FontSize="12"
                                               TextTrimming="CharacterEllipsis" MaxWidth="600" Margin="0,4,0,0"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                        <TextBlock Text="{Binding TypBezeichnung}" Foreground="#888" FontSize="11"/>
                                        <TextBlock Text=" | " Foreground="#ccc" FontSize="11"/>
                                        <TextBlock Text="{Binding BereicheText}" Foreground="#888" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Status -->
                                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                    <Border Padding="8,3" CornerRadius="3" HorizontalAlignment="Right">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="#e8f5e9"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding NAktiv}" Value="False">
                                                        <Setter Property="Background" Value="#f5f5f5"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <TextBlock FontSize="11">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Text" Value="Aktiv"/>
                                                    <Setter Property="Foreground" Value="#4caf50"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding NAktiv}" Value="False">
                                                            <Setter Property="Text" Value="Inaktiv"/>
                                                            <Setter Property="Foreground" Value="#999"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Border>
                                    <TextBlock Text="{Binding ZuweisungenText}" Foreground="#888" FontSize="10"
                                               HorizontalAlignment="Right" Margin="0,4,0,0"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Padding" Value="0"/>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#e3f2fd"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#f5f5f5"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.ItemContainerStyle>
            </ListBox>
        </Border>

        <!-- Leer-Hinweis -->
        <TextBlock x:Name="txtLeerHinweis" Grid.Row="2" Text="Keine Textmeldungen vorhanden. Klicken Sie auf '+ Neue Meldung' um eine anzulegen."
                   Foreground="#888" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
    </Grid>
</UserControl>

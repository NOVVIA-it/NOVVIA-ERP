<Window x:Class="NovviaERP.WPF.Views.AusgabeDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ausgabe" Height="700" Width="950"
        WindowStartupLocation="CenterOwner" Background="#F0F0F0"
        ResizeMode="CanResize" MinWidth="800" MinHeight="600">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Linke Seite: Optionen -->
        <Border Grid.Column="0" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="15">
                    <!-- Titel -->
                    <TextBlock x:Name="txtTitel" Text="Rechnung ausgeben" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <TextBlock x:Name="txtDokumentInfo" Text="Rechnung RE-2024-001" Foreground="#666" Margin="0,0,0,15"/>

                    <!-- Formular-Auswahl -->
                    <Border Background="#F8F8F8" CornerRadius="4" Padding="12" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="Formular" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <ComboBox x:Name="cbFormular" Height="28" SelectionChanged="CbFormular_SelectionChanged">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                    </Border>

                    <!-- Ausgabe-Optionen -->
                    <TextBlock Text="Ausgabe" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10"/>

                    <!-- Vorschau -->
                    <Border Background="#F8F8F8" CornerRadius="4" Padding="10" Margin="0,0,0,8">
                        <StackPanel>
                            <CheckBox x:Name="chkVorschau" Content="Vorschau anzeigen" IsChecked="True" FontSize="13" Checked="ChkVorschau_Changed" Unchecked="ChkVorschau_Changed"/>
                        </StackPanel>
                    </Border>

                    <!-- Drucken -->
                    <Border Background="#F8F8F8" CornerRadius="4" Padding="10" Margin="0,0,0,8">
                        <StackPanel>
                            <CheckBox x:Name="chkDrucken" Content="Drucken" FontSize="13" IsChecked="False"/>
                            <StackPanel x:Name="pnlDruckOptionen" Margin="20,8,0,0" Visibility="Collapsed">
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Drucker:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cbDrucker" Grid.Column="1" Height="24"/>
                                </Grid>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Kopien:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtKopien" Grid.Column="1" Text="1" Height="24" VerticalContentAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Speichern -->
                    <Border Background="#F8F8F8" CornerRadius="4" Padding="10" Margin="0,0,0,8">
                        <StackPanel>
                            <CheckBox x:Name="chkSpeichern" Content="Speichern" FontSize="13"/>
                            <StackPanel x:Name="pnlSpeichernOptionen" Margin="20,8,0,0" Visibility="Collapsed">
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="30"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="txtSpeicherPfad" Height="24" VerticalContentAlignment="Center" IsReadOnly="True"/>
                                    <Button Grid.Column="1" Content="..." Width="26" Height="24" Click="BtnPfadWaehlen_Click"/>
                                </Grid>
                                <CheckBox x:Name="chkArchivieren" Content="Im System archivieren" IsChecked="True"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- E-Mail -->
                    <Border Background="#F8F8F8" CornerRadius="4" Padding="10" Margin="0,0,0,8">
                        <StackPanel>
                            <CheckBox x:Name="chkEmail" Content="Per E-Mail senden" FontSize="13"/>
                            <StackPanel x:Name="pnlEmailOptionen" Margin="20,8,0,0" Visibility="Collapsed">
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="An:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtEmpfaenger" Grid.Column="1" Height="24" VerticalContentAlignment="Center"/>
                                </Grid>
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="CC:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtCC" Grid.Column="1" Height="24" VerticalContentAlignment="Center"/>
                                </Grid>
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Vorlage:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="cbEmailVorlage" Grid.Column="1" Height="24">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Name}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                </Grid>
                                <CheckBox x:Name="chkEmailVorschau" Content="E-Mail vor dem Senden anzeigen" IsChecked="True"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Fax (optional, wie JTL) -->
                    <Border Background="#F8F8F8" CornerRadius="4" Padding="10" Margin="0,0,0,15" Visibility="Collapsed">
                        <StackPanel>
                            <CheckBox x:Name="chkFax" Content="Per Fax senden" FontSize="13"/>
                        </StackPanel>
                    </Border>

                    <!-- Status -->
                    <TextBlock x:Name="txtStatus" Text="" Foreground="#666" TextWrapping="Wrap" Margin="0,5,0,0"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Rechte Seite: Vorschau -->
        <Grid Grid.Column="1" Background="#E8E8E8">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Vorschau-Toolbar -->
            <Border Grid.Row="0" Background="White" BorderBrush="#D0D0D0" BorderThickness="0,0,0,1" Padding="10,8">
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="btnZoomOut" Content="-" Width="28" Height="28" Click="BtnZoomOut_Click" ToolTip="Verkleinern"/>
                    <TextBlock x:Name="txtZoom" Text="100%" Width="50" TextAlignment="Center" VerticalAlignment="Center" Margin="5,0"/>
                    <Button x:Name="btnZoomIn" Content="+" Width="28" Height="28" Click="BtnZoomIn_Click" ToolTip="Vergroessern"/>
                    <Rectangle Width="1" Fill="#D0D0D0" Margin="10,2"/>
                    <Button x:Name="btnSeiteZurueck" Content="&lt;" Width="28" Height="28" Click="BtnSeiteZurueck_Click" ToolTip="Vorherige Seite"/>
                    <TextBlock x:Name="txtSeite" Text="Seite 1 von 1" Width="90" TextAlignment="Center" VerticalAlignment="Center" Margin="5,0"/>
                    <Button x:Name="btnSeiteVor" Content="&gt;" Width="28" Height="28" Click="BtnSeiteVor_Click" ToolTip="Naechste Seite"/>
                    <Rectangle Width="1" Fill="#D0D0D0" Margin="10,2"/>
                    <Button x:Name="btnAktualisieren" Content="Aktualisieren" Width="90" Height="28" Click="BtnAktualisieren_Click"/>
                </StackPanel>
            </Border>

            <!-- PDF-Vorschau -->
            <Border Grid.Row="1" Margin="15" Background="White" CornerRadius="4">
                <Grid>
                    <!-- Vorschau-Container -->
                    <ScrollViewer x:Name="scrollVorschau" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                        <Image x:Name="imgVorschau" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Top"/>
                    </ScrollViewer>

                    <!-- Lade-Anzeige -->
                    <Border x:Name="pnlLaden" Background="#80FFFFFF" Visibility="Collapsed">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="Vorschau wird erstellt..." FontSize="14"/>
                            <ProgressBar IsIndeterminate="True" Width="200" Height="4" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Keine Vorschau -->
                    <Border x:Name="pnlKeineVorschau" Background="#F8F8F8" Visibility="Collapsed">
                        <TextBlock Text="Keine Vorschau verfuegbar" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="#999"/>
                    </Border>
                </Grid>
            </Border>

            <!-- Buttons -->
            <Border Grid.Row="2" Background="White" BorderBrush="#D0D0D0" BorderThickness="0,1,0,0" Padding="15,12">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Content="Abbrechen" Width="100" Height="32" IsCancel="True" Margin="0,0,10,0"/>
                        <Button x:Name="btnAusfuehren" Content="Ausfuehren" Width="120" Height="32" Click="BtnAusfuehren_Click" IsDefault="True" Background="#0078D4" Foreground="White"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>

<Window x:Class="NovviaERP.WPF.Views.NeueBestellungView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Neue Bestellung anlegen" Height="700" Width="900"
        WindowStartupLocation="CenterOwner" Background="#f0f2f5">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="Neue Bestellung anlegen" FontSize="24" FontWeight="Bold" Margin="0,0,0,15"/>

        <!-- Kunde auswaehlen -->
        <Border Grid.Row="1" Background="White" CornerRadius="6" Padding="15" Margin="0,0,0,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Kunde" FontWeight="SemiBold" Margin="0,0,0,8"/>

                <StackPanel Grid.Row="1" Orientation="Horizontal">
                    <TextBox x:Name="txtKundeSuche" Width="300" Height="32" Padding="8,5"
                             KeyDown="TxtKundeSuche_KeyDown" ToolTip="Kundennr, Name, Firma..."/>
                    <Button Content="Suchen" Click="KundeSuchen_Click" Margin="8,0,0,0" Padding="12,5"
                            Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0"/>
                </StackPanel>

                <Border Grid.Row="1" Grid.Column="1" Background="#f8f9fa" CornerRadius="4" Padding="12,8" MinWidth="300">
                    <StackPanel>
                        <TextBlock x:Name="txtKundeInfo" Text="Kein Kunde ausgewaehlt" FontWeight="SemiBold"/>
                        <TextBlock x:Name="txtKundeAdresse" Text="" Foreground="#666" FontSize="12" Margin="0,3,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Positionen -->
        <Border Grid.Row="2" Background="White" CornerRadius="6" Padding="15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Positionen" FontWeight="SemiBold" Margin="0,0,0,10"/>

                <!-- Artikel hinzufuegen -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBox x:Name="txtArtikelSuche" Width="200" Height="32" Padding="8,5"
                             KeyDown="TxtArtikelSuche_KeyDown" ToolTip="Art-Nr, PZN, EAN, Name..."/>
                    <Button Content="Artikel suchen" Click="ArtikelSuchen_Click" Margin="8,0,0,0" Padding="12,5"/>
                    <TextBlock x:Name="txtArtikelInfo" VerticalAlignment="Center" Margin="15,0,0,0" Foreground="#666"/>
                    <TextBox x:Name="txtMenge" Width="60" Height="32" Text="1" Padding="8,5" Margin="15,0,0,0"
                             ToolTip="Menge"/>
                    <Button Content="Hinzufuegen" Click="ArtikelHinzufuegen_Click" Margin="8,0,0,0" Padding="12,5"
                            Background="#28a745" Foreground="White" BorderThickness="0" x:Name="btnHinzufuegen" IsEnabled="False"/>
                </StackPanel>

                <!-- Positionsliste -->
                <DataGrid x:Name="dgPositionen" Grid.Row="2" AutoGenerateColumns="False"
                          GridLinesVisibility="Horizontal" HeadersVisibility="Column"
                          CanUserAddRows="False" CanUserDeleteRows="False"
                          BorderThickness="1" BorderBrush="#ddd"
                          RowBackground="White" AlternatingRowBackground="#fafafa">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Art-Nr" Binding="{Binding ArtNr}" Width="100" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Bezeichnung" Binding="{Binding Name}" Width="*" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Menge" Binding="{Binding Menge}" Width="70">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="VK Netto" Binding="{Binding VKNetto, StringFormat=N2}" Width="80" IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Gesamt" Binding="{Binding Gesamt, StringFormat=N2}" Width="90" IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn Header="" Width="40">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="X" Click="PositionEntfernen_Click"
                                            Foreground="Red" Background="Transparent" BorderThickness="0"
                                            Cursor="Hand" ToolTip="Position entfernen"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- Summen -->
        <Border Grid.Row="3" Background="White" CornerRadius="6" Padding="15" Margin="0,15,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="1" HorizontalAlignment="Right" MinWidth="200">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="100"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="Summe Netto:" HorizontalAlignment="Right" Margin="0,0,10,5"/>
                        <TextBlock x:Name="txtSummeNetto" Grid.Column="1" Text="0,00 EUR" HorizontalAlignment="Right" Margin="0,0,0,5"/>

                        <TextBlock Grid.Row="1" Text="MwSt (19%):" HorizontalAlignment="Right" Margin="0,0,10,5"/>
                        <TextBlock x:Name="txtMwSt" Grid.Row="1" Grid.Column="1" Text="0,00 EUR" HorizontalAlignment="Right" Margin="0,0,0,5"/>

                        <TextBlock Grid.Row="2" Text="Gesamt Brutto:" HorizontalAlignment="Right" Margin="0,0,10,0" FontWeight="Bold"/>
                        <TextBlock x:Name="txtSummeBrutto" Grid.Row="2" Grid.Column="1" Text="0,00 EUR" HorizontalAlignment="Right" FontWeight="Bold" FontSize="14"/>
                    </Grid>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Abbrechen" Click="Abbrechen_Click" Padding="20,10" Margin="0,0,10,0"/>
            <Button x:Name="btnSpeichern" Content="Bestellung anlegen" Click="Speichern_Click"
                    Padding="20,10" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0"
                    FontWeight="SemiBold" IsEnabled="False"/>
        </StackPanel>
    </Grid>
</Window>

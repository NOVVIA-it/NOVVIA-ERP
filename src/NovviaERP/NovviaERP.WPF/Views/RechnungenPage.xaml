<Page x:Class="NovviaERP.WPF.Views.RechnungenPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Rechnungen" Background="#f0f2f5">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Rechnungen" FontSize="28" FontWeight="Bold"/>

        <!-- Suche und Filter -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,15">
            <TextBox x:Name="txtSuche" Width="300" Height="35" VerticalContentAlignment="Center"/>
            <Button Content="Suchen" Width="100" Margin="10,0" Click="Suchen_Click"/>
            <ComboBox x:Name="cmbStatus" Width="150" Height="35" SelectedIndex="0">
                <ComboBoxItem Content="Alle"/>
                <ComboBoxItem Content="Offen"/>
                <ComboBoxItem Content="Bezahlt"/>
                <ComboBoxItem Content="Storniert"/>
            </ComboBox>
            <Button Content="PDF" Width="80" Margin="20,0,5,0" Click="PDF_Click"/>
            <Button Content="Drucken" Width="80" Margin="0,0,5,0" Click="Drucken_Click"/>
        </StackPanel>

        <!-- Rechnungsliste -->
        <DataGrid x:Name="dgRechnungen" Grid.Row="2" AutoGenerateColumns="False" IsReadOnly="True"
                  SelectionMode="Single" CanUserAddRows="False" MouseDoubleClick="DgRechnungen_DoubleClick">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Rechnungsnr." Binding="{Binding RechnungsNr}" Width="130"/>
                <DataGridTextColumn Header="Datum" Binding="{Binding Erstellt, StringFormat=dd.MM.yyyy}" Width="100"/>
                <DataGridTextColumn Header="Kunde" Binding="{Binding KundeName}" Width="200"/>
                <DataGridTextColumn Header="FÃ¤llig" Binding="{Binding Faellig, StringFormat=dd.MM.yyyy}" Width="100"/>
                <DataGridTextColumn Header="Brutto" Binding="{Binding Brutto, StringFormat=N2}" Width="100">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Offen" Binding="{Binding Offen, StringFormat=N2}" Width="100">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                <DataGridTextColumn Header="Mahnstufe" Binding="{Binding Mahnstufe}" Width="80"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Footer mit Aktionen -->
        <Border Grid.Row="3" BorderBrush="#ddd" BorderThickness="0,1,0,0" Padding="0,15,0,0" Margin="0,10,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="txtStatus" Foreground="#666" VerticalAlignment="Center"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Stornieren" Width="100" Margin="0,0,10,0" Click="Stornieren_Click"
                            Background="#dc3545" Foreground="White" BorderThickness="0"
                            ToolTip="Rechnung stornieren - Auftrag wieder bearbeitbar (keine Lagerbewegung)"/>
                    <Button Content="Gutschrift" Width="100" Margin="0,0,10,0" Click="Rechnungskorrektur_Click"
                            Background="#ffc107" Foreground="#333" BorderThickness="0"
                            ToolTip="Gutschrift (Rechnungskorrektur) erstellen - korrigiert Rechnungsbetrag"/>
                    <Button Content="Zahlung erfassen" Width="120" Click="ZahlungErfassen_Click"
                            Background="#28a745" Foreground="White" BorderThickness="0"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>

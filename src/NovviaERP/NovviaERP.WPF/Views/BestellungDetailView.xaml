<UserControl x:Class="NovviaERP.WPF.Views.BestellungDetailView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#f5f5f5">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Background="#0078D4" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Button Content="Zurück" Click="Zurueck_Click" Padding="10,5" VerticalAlignment="Center"
                        Background="White" Foreground="#333"/>
                <StackPanel Grid.Column="1" Margin="20,0,0,0" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="txtTitel" Text="Auftrag" FontSize="18" FontWeight="SemiBold" Foreground="White"/>
                        <TextBlock Text=" - " Foreground="White" FontSize="18"/>
                        <TextBlock x:Name="txtBestellNr" FontSize="18" Foreground="White" FontWeight="SemiBold"/>
                        <TextBlock Text=" - " Foreground="White" FontSize="18"/>
                        <TextBlock x:Name="txtKundeName" FontSize="18" Foreground="White"/>
                    </StackPanel>
                    <TextBlock x:Name="txtSubtitel" Text="Hier koennen Sie den Auftrag bearbeiten."
                               FontSize="11" Foreground="#cce5ff" Margin="0,2,0,0"/>
                </StackPanel>
                <Border x:Name="brdStatus" Grid.Column="2" Background="#28a745" CornerRadius="3"
                        Padding="12,5" VerticalAlignment="Center">
                    <TextBlock x:Name="txtStatusBadge" Text="Offen" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                </Border>
            </Grid>
        </Border>

        <!-- Oberer Bereich: Auftragsdaten links, Details rechts -->
        <Grid Grid.Row="1" Margin="10,10,10,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="350"/>
            </Grid.ColumnDefinitions>

            <!-- Linke Seite: Auftragsdaten + Adressen -->
            <Border Background="White" BorderBrush="#ddd" BorderThickness="1" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Tabs: Auftragsdaten, Anhaenge, Kosten -->
                    <Border Background="#f0f0f0" BorderBrush="#ddd" BorderThickness="0,0,0,1">
                        <StackPanel Orientation="Horizontal">
                            <Border x:Name="tabAuftragsdaten" Background="#0078D4" Padding="12,8" Cursor="Hand"
                                    MouseLeftButtonDown="TabAuftragsdaten_Click">
                                <TextBlock Text="Auftragsdaten" Foreground="White" FontWeight="SemiBold"/>
                            </Border>
                            <Border x:Name="tabAnhaenge" Background="Transparent" Padding="12,8" Cursor="Hand"
                                    MouseLeftButtonDown="TabAnhaenge_Click">
                                <TextBlock Text="Anhaenge" Foreground="#666"/>
                            </Border>
                            <Border x:Name="tabKosten" Background="Transparent" Padding="12,8" Cursor="Hand"
                                    MouseLeftButtonDown="TabKosten_Click">
                                <TextBlock Text="Kosten" Foreground="#666"/>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Auftragsdaten Content -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="15">
                            <!-- Referenzen -->
                            <Border BorderBrush="#ccc" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                                <StackPanel>
                                    <TextBlock Text="Referenzen" FontWeight="SemiBold" Foreground="#666" Margin="0,0,0,10"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="130"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="130"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="28"/>
                                            <RowDefinition Height="28"/>
                                            <RowDefinition Height="28"/>
                                            <RowDefinition Height="28"/>
                                            <RowDefinition Height="28"/>
                                        </Grid.RowDefinitions>

                                        <!-- Linke Spalte -->
                                        <TextBlock Text="Firma:" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtFirma" Grid.Column="1" VerticalAlignment="Center" IsReadOnly="True"
                                                 Background="#f8f8f8"/>

                                        <TextBlock Text="Auftragsnummer:" Grid.Row="1" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="txtBestellNrDetail" Grid.Row="1" Grid.Column="1"
                                                   VerticalAlignment="Center" FontWeight="SemiBold" Foreground="#0078D4"/>

                                        <TextBlock Text="Auftragsdatum:" Grid.Row="2" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="txtDatum" Grid.Row="2" Grid.Column="1" VerticalAlignment="Center"/>

                                        <TextBlock Text="Kundennummer:" Grid.Row="3" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                            <TextBlock x:Name="txtKundenNr" VerticalAlignment="Center" Foreground="#0078D4"
                                                       Cursor="Hand" TextDecorations="Underline"
                                                       MouseLeftButtonDown="KundeOeffnen_Click"/>
                                        </StackPanel>

                                        <TextBlock Text="Kundengruppe:" Grid.Row="4" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="txtKundengruppe" Grid.Row="4" Grid.Column="1" VerticalAlignment="Center"/>

                                        <!-- Rechte Spalte -->
                                        <TextBlock Text="Externe Auftr.Nr.:" Grid.Column="3" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtExterneNr" Grid.Column="4" VerticalAlignment="Center"/>

                                        <TextBlock Text="Rechnungsnummer:" Grid.Row="1" Grid.Column="3" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="txtRechnungsNr" Grid.Row="1" Grid.Column="4"
                                                   VerticalAlignment="Center" Foreground="#0078D4"/>

                                        <TextBlock Text="Eigene USt-IdNr.:" Grid.Row="2" Grid.Column="3" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="txtEigeneUstId" Grid.Row="2" Grid.Column="4" VerticalAlignment="Center"/>

                                        <TextBlock Text="Kunden-USt-IdNr.:" Grid.Row="3" Grid.Column="3" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="txtKundenUstId" Grid.Row="3" Grid.Column="4" VerticalAlignment="Center"/>

                                        <TextBlock Text="Status:" Grid.Row="4" Grid.Column="3" VerticalAlignment="Center"/>
                                        <ComboBox x:Name="cmbStatus" Grid.Row="4" Grid.Column="4" VerticalAlignment="Center">
                                            <ComboBoxItem Content="Offen" Tag="Offen"/>
                                            <ComboBoxItem Content="In Bearbeitung" Tag="In Bearbeitung"/>
                                            <ComboBoxItem Content="Bezahlt" Tag="Bezahlt"/>
                                            <ComboBoxItem Content="Versendet" Tag="Versendet"/>
                                            <ComboBoxItem Content="Storniert" Tag="Storniert"/>
                                        </ComboBox>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Adressen -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="10"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Rechnungsadresse -->
                                <Border BorderBrush="#ccc" BorderThickness="1">
                                    <StackPanel>
                                        <Border Background="#f0f0f0" Padding="8,5">
                                            <TextBlock Text="Rechnungsadresse" FontWeight="SemiBold" Foreground="#666"/>
                                        </Border>
                                        <TextBlock x:Name="txtRechnungsadresse" Padding="10" TextWrapping="Wrap"
                                                   MinHeight="80" FontSize="12"/>
                                        <Border BorderBrush="#ddd" BorderThickness="0,1,0,0" Padding="5">
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="Auswaehlen" Padding="8,3" Margin="0,0,5,0" FontSize="11"
                                                        Click="RechnungsadresseAuswaehlen_Click"/>
                                                <Button Content="Bearbeiten" Padding="8,3" FontSize="11"
                                                        Click="RechnungsadresseBearbeiten_Click"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>

                                <!-- Lieferadresse -->
                                <Border Grid.Column="2" BorderBrush="#ccc" BorderThickness="1">
                                    <StackPanel>
                                        <Border Background="#f0f0f0" Padding="8,5">
                                            <TextBlock Text="Lieferadresse (abweichend)" FontWeight="SemiBold" Foreground="#666"/>
                                        </Border>
                                        <TextBlock x:Name="txtLieferadresse" Padding="10" TextWrapping="Wrap"
                                                   MinHeight="80" FontSize="12"/>
                                        <Border BorderBrush="#ddd" BorderThickness="0,1,0,0" Padding="5">
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="Auswaehlen" Padding="8,3" Margin="0,0,5,0" FontSize="11"
                                                        Click="LieferadresseAuswaehlen_Click"/>
                                                <Button Content="Bearbeiten" Padding="8,3" FontSize="11"
                                                        Click="LieferadresseBearbeiten_Click"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- Rechte Seite: Details/Texte/Eigene Felder -->
            <Border Grid.Column="2" Background="White" BorderBrush="#ddd" BorderThickness="1" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Tabs -->
                    <Border Background="#f0f0f0" BorderBrush="#ddd" BorderThickness="0,0,0,1">
                        <StackPanel Orientation="Horizontal">
                            <Border x:Name="tabDetails" Background="#0078D4" Padding="10,8" Cursor="Hand"
                                    MouseLeftButtonDown="TabDetails_Click">
                                <TextBlock Text="Details" Foreground="White" FontWeight="SemiBold" FontSize="11"/>
                            </Border>
                            <Border x:Name="tabTexte" Background="Transparent" Padding="10,8" Cursor="Hand"
                                    MouseLeftButtonDown="TabTexte_Click">
                                <TextBlock Text="Texte" Foreground="#666" FontSize="11"/>
                            </Border>
                            <Border x:Name="tabEigeneFelder" Background="Transparent" Padding="10,8" Cursor="Hand"
                                    MouseLeftButtonDown="TabEigeneFelder_Click">
                                <TextBlock Text="Eigene Felder" Foreground="#666" FontSize="11"/>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Tab Content Container -->
                    <Grid Grid.Row="1">
                        <!-- Details Tab (JTL-Style) -->
                        <ScrollViewer x:Name="pnlDetails" VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="8">
                                <!-- Auftragsstatus -->
                                <GroupBox Header="Auftragsstatus" Margin="0,0,0,8" Padding="5">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Vorgangsstatus:" VerticalAlignment="Center" FontSize="11"/>
                                        <TextBox x:Name="txtDetailVorgangsstatus" Grid.Column="1" FontSize="11"
                                                 IsReadOnly="True" Background="#f8f8f8"/>
                                        <TextBlock Text="Vorgangsfarbe:" Grid.Row="1" VerticalAlignment="Center" FontSize="11"/>
                                        <ComboBox x:Name="cmbVorgangsfarbe" Grid.Row="1" Grid.Column="1" FontSize="11" IsEnabled="False"/>
                                        <TextBlock Text="Rueckhaltegrund:" Grid.Row="2" VerticalAlignment="Center" FontSize="11"/>
                                        <TextBox x:Name="txtRueckhaltegrund" Grid.Row="2" Grid.Column="1" FontSize="11"
                                                 IsReadOnly="True" Background="#f8f8f8"/>
                                    </Grid>
                                </GroupBox>

                                <!-- Steuern -->
                                <GroupBox Header="Steuern" Margin="0,0,0,8" Padding="5">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Steuerart:" VerticalAlignment="Center" FontSize="11"/>
                                        <TextBox x:Name="txtSteuerart" Grid.Column="1" FontSize="11"
                                                 IsReadOnly="True" Background="#f8f8f8"/>
                                        <TextBlock Text="Sonderbehdlg.:" Grid.Row="1" VerticalAlignment="Center" FontSize="11"/>
                                        <ComboBox x:Name="cmbSonderbehandlung" Grid.Row="1" Grid.Column="1" FontSize="11">
                                            <ComboBoxItem Content="Keine" IsSelected="True"/>
                                        </ComboBox>
                                    </Grid>
                                </GroupBox>

                                <!-- Zahlung -->
                                <GroupBox Header="Zahlung" Margin="0,0,0,8" Padding="5">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Zahlungsart:" VerticalAlignment="Center" FontSize="11"/>
                                        <TextBox x:Name="txtDetailZahlungsart" Grid.Column="1" FontSize="11"
                                                 IsReadOnly="True" Background="#f8f8f8"/>
                                        <TextBlock Text="Zahlungsziel:" Grid.Row="1" VerticalAlignment="Center" FontSize="11"/>
                                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                                            <TextBox x:Name="txtZahlungsziel" Width="50" FontSize="11" IsReadOnly="True" Background="#f8f8f8"/>
                                            <TextBlock Text=" Tage" VerticalAlignment="Center" FontSize="11"/>
                                        </StackPanel>
                                        <TextBlock Text="Skonto:" Grid.Row="2" VerticalAlignment="Center" FontSize="11"/>
                                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                            <TextBox x:Name="txtSkontoProzent" Width="40" FontSize="11" IsReadOnly="True" Background="#f8f8f8"/>
                                            <TextBlock Text=" % in " VerticalAlignment="Center" FontSize="11"/>
                                            <TextBox x:Name="txtSkontoTage" Width="40" FontSize="11" IsReadOnly="True" Background="#f8f8f8"/>
                                            <TextBlock Text=" Tagen" VerticalAlignment="Center" FontSize="11"/>
                                        </StackPanel>
                                    </Grid>
                                </GroupBox>

                                <!-- Versand -->
                                <GroupBox Header="Versand" Margin="0,0,0,8" Padding="5">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                            <RowDefinition Height="26"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Vorauss. Lief.:" VerticalAlignment="Center" FontSize="11"/>
                                        <TextBox x:Name="txtVoraussLieferdatum" Grid.Column="1" FontSize="11"
                                                 IsReadOnly="True" Background="#f8f8f8"/>
                                        <TextBlock Text="Versandart:" Grid.Row="1" VerticalAlignment="Center" FontSize="11"/>
                                        <TextBox x:Name="txtDetailVersandart" Grid.Row="1" Grid.Column="1" FontSize="11"
                                                 IsReadOnly="True" Background="#f8f8f8"/>
                                        <TextBlock Text="Zusatzgewicht:" Grid.Row="2" VerticalAlignment="Center" FontSize="11"/>
                                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                            <TextBox x:Name="txtDetailZusatzgewicht" Width="60" FontSize="11" IsReadOnly="True" Background="#f8f8f8"/>
                                            <TextBlock Text=" kg" VerticalAlignment="Center" FontSize="11"/>
                                        </StackPanel>
                                        <TextBlock Text="Lieferprioritaet:" Grid.Row="3" VerticalAlignment="Center" FontSize="11"/>
                                        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                            <TextBox x:Name="txtLieferprioritaet" Width="40" FontSize="11" IsReadOnly="True" Background="#f8f8f8"/>
                                            <TextBlock Text=" (0=normal)" VerticalAlignment="Center" FontSize="11" Foreground="#999"/>
                                        </StackPanel>
                                    </Grid>
                                </GroupBox>

                                <!-- Referenzen -->
                                <GroupBox Header="Referenzen" Padding="5">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="26"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Sprache:" VerticalAlignment="Center" FontSize="11"/>
                                        <TextBox x:Name="txtDetailSprache" Grid.Column="1" FontSize="11"
                                                 IsReadOnly="True" Background="#f8f8f8"/>
                                    </Grid>
                                </GroupBox>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- Texte Tab (aus Verkauf.tAuftragText) -->
                        <ScrollViewer x:Name="pnlTexte" VerticalScrollBarVisibility="Auto" Visibility="Collapsed">
                            <StackPanel Margin="10">
                                <TextBlock Text="Anmerkung (extern sichtbar)" FontWeight="SemiBold" Foreground="#666" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtTextAnmerkung" Height="80" AcceptsReturn="True"
                                         TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"/>

                                <TextBlock Text="Drucktext (fuer Dokumente)" FontWeight="SemiBold" Foreground="#666" Margin="0,15,0,5"/>
                                <TextBox x:Name="txtDrucktext" Height="80" AcceptsReturn="True"
                                         TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"/>

                                <TextBlock Text="Hinweis (intern)" FontWeight="SemiBold" Foreground="#666" Margin="0,15,0,5"/>
                                <TextBox x:Name="txtHinweis" Height="60" AcceptsReturn="True"
                                         TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                                         Background="#fff8f0" BorderBrush="#e0d0c0"/>

                                <TextBlock Text="Vorgangsstatus" FontWeight="SemiBold" Foreground="#666" Margin="0,15,0,5"/>
                                <TextBox x:Name="txtVorgangsstatus" Height="30" IsReadOnly="True"
                                         Background="#f5f5f5"/>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- Eigene Felder Tab -->
                        <ScrollViewer x:Name="pnlEigeneFelder" VerticalScrollBarVisibility="Auto" Visibility="Collapsed">
                            <StackPanel Margin="10">
                                <TextBlock Text="Eigene Felder" FontWeight="SemiBold" Foreground="#666" Margin="0,0,0,10"/>
                                <DataGrid x:Name="dgEigeneFelder" AutoGenerateColumns="False" CanUserAddRows="False"
                                          HeadersVisibility="Column" BorderThickness="1" BorderBrush="#ddd"
                                          RowBackground="White" AlternatingRowBackground="#fafafa" Height="200">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Feldname" Binding="{Binding FeldName}" Width="150" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Wert" Binding="{Binding Wert}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <TextBlock Text="Doppelklick zum Bearbeiten" FontSize="10" Foreground="#999" Margin="0,5,0,0"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </Border>
        </Grid>

        <!-- Positionen Bereich -->
        <Grid Grid.Row="2" Margin="10,5,10,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>

            <!-- Positionen Grid -->
            <Border Background="White" BorderBrush="#ddd" BorderThickness="1" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Positionen Header -->
                    <Border Background="#d9534f" Padding="10,6">
                        <TextBlock Text="Positionen" Foreground="White" FontWeight="SemiBold"/>
                    </Border>

                    <!-- DataGrid -->
                    <DataGrid x:Name="dgPositionen" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                              RowBackground="White" AlternatingRowBackground="#fafafa"
                              BorderThickness="0" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Art" Width="35">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Artikelnummer" Binding="{Binding CArtNr}" Width="110"/>
                            <DataGridTextColumn Header="Menge" Binding="{Binding FAnzahl, StringFormat=N2}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Positionsname" Binding="{Binding CName}" Width="*"/>
                            <DataGridTextColumn Header="Brutto-VK" Binding="{Binding FVKBrutto, StringFormat=N2}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="MwSt." Binding="{Binding FMwSt, StringFormat={}{0:N2} %}" Width="65">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Netto-VK" Binding="{Binding FVKNetto, StringFormat=N2}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Rabatt (%)" Binding="{Binding FRabatt, StringFormat={}{0:N2} %}" Width="75">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Netto-VK (ges.)" Binding="{Binding SummeNetto, StringFormat=N2}" Width="95">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                        <Setter Property="Padding" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Positionen Toolbar -->
                    <Border Grid.Row="2" Background="#f5f5f5" BorderBrush="#ddd" BorderThickness="0,1,0,0" Padding="8,5">
                        <StackPanel Orientation="Horizontal">
                            <TextBox x:Name="txtArtikelSuche" Width="120" Height="26"
                                     VerticalContentAlignment="Center" Margin="0,0,5,0"/>
                            <Button Content="Suchen" Padding="8,3" Margin="0,0,10,0" Click="ArtikelSuchen_Click"/>
                            <Button Content="Freiposition hinzufügen" Padding="8,3" Margin="0,0,5,0"
                                    Click="FreipositionHinzufuegen_Click"/>
                            <Button Content="Löschen" Padding="8,3" Margin="0,0,5,0" Click="PositionLoeschen_Click"/>
                            <Button Content="Rabatt (%) setzen" Padding="8,3" Margin="0,0,5,0" Click="RabattSetzen_Click"/>
                            <Button Content="Preise neu ermitteln" Padding="8,3" Margin="0,0,10,0" Click="PreiseNeuErmitteln_Click"/>
                            <Button Content="▲" Width="28" Padding="0,3" Margin="0,0,2,0" Click="PositionRauf_Click" ToolTip="Position nach oben"/>
                            <Button Content="▼" Width="28" Padding="0,3" Click="PositionRunter_Click" ToolTip="Position nach unten"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Rechte Seite: Zusammenfassung -->
            <Border Grid.Column="1" Background="White" BorderBrush="#ddd" BorderThickness="1" CornerRadius="4" Margin="10,0,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Tabs -->
                    <Border Background="#f0f0f0" BorderBrush="#ddd" BorderThickness="0,0,0,1">
                        <StackPanel Orientation="Horizontal">
                            <Border x:Name="tabZusammenfassung" Background="#5bc0de" Padding="8,6" Cursor="Hand">
                                <TextBlock Text="Zusammenfassung" Foreground="White" FontWeight="SemiBold" FontSize="11"/>
                            </Border>
                            <Border x:Name="tabHistorie" Background="Transparent" Padding="8,6" Cursor="Hand">
                                <TextBlock Text="Historie/Notizen" Foreground="#666" FontSize="11"/>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Zusammenfassung Content -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="10">
                            <!-- Versandinfo -->
                            <TextBlock Text="Versandinfo" FontWeight="SemiBold" Foreground="#666" Margin="0,0,0,8"/>
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="22"/>
                                    <RowDefinition Height="22"/>
                                    <RowDefinition Height="22"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Versandgewicht:" FontSize="11"/>
                                <TextBlock x:Name="txtVersandgewicht" Grid.Column="1" Text="0,000 kg" FontSize="11"/>

                                <TextBlock Text="Artikelgewicht:" Grid.Row="1" FontSize="11"/>
                                <TextBlock x:Name="txtArtikelgewicht" Grid.Row="1" Grid.Column="1" Text="0,000 kg" FontSize="11"/>

                                <TextBlock Text="Gesamtgewicht:" Grid.Row="2" FontSize="11" FontWeight="SemiBold"/>
                                <TextBlock x:Name="txtGesamtgewicht" Grid.Row="2" Grid.Column="1" Text="0,000 kg"
                                           FontSize="11" FontWeight="SemiBold"/>
                            </Grid>

                            <Border BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,0,0,10"/>

                            <!-- Auftragswert -->
                            <TextBlock Text="Auftragswert" FontWeight="SemiBold" Foreground="#666" Margin="0,0,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="24"/>
                                    <RowDefinition Height="24"/>
                                    <RowDefinition Height="24"/>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="24"/>
                                    <RowDefinition Height="24"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Gesamtbetrag netto:" FontSize="11"/>
                                <TextBlock x:Name="txtSummeNetto" Grid.Column="1" Text="0,00 EUR" FontSize="11"/>

                                <TextBlock Text="MwSt. 19,00 %:" Grid.Row="1" FontSize="11"/>
                                <TextBlock x:Name="txtMwSt" Grid.Row="1" Grid.Column="1" Text="0,00 EUR" FontSize="11"/>

                                <TextBlock Text="Gewinn netto:" Grid.Row="2" FontSize="11"/>
                                <TextBlock x:Name="txtGewinn" Grid.Row="2" Grid.Column="1" Text="0,00 EUR"
                                           FontSize="11" Foreground="#28a745"/>

                                <TextBlock Text="Gesamtbetrag brutto:" Grid.Row="3" FontSize="12" FontWeight="Bold"/>
                                <TextBlock x:Name="txtGesamtBrutto" Grid.Row="3" Grid.Column="1" Text="0,00 EUR"
                                           FontSize="13" FontWeight="Bold" Foreground="#0078D4"/>

                                <TextBlock Text="Kosten (netto):" Grid.Row="4" FontSize="11"/>
                                <TextBlock x:Name="txtKosten" Grid.Row="4" Grid.Column="1" Text="0,00 EUR" FontSize="11"/>

                                <TextBlock Text="Waehrung:" Grid.Row="5" FontSize="11"/>
                                <ComboBox x:Name="cmbWaehrung" Grid.Row="5" Grid.Column="1" Width="60" Height="22"
                                          FontSize="11" SelectedIndex="0">
                                    <ComboBoxItem Content="EUR"/>
                                    <ComboBoxItem Content="USD"/>
                                    <ComboBoxItem Content="CHF"/>
                                </ComboBox>
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Footer -->
        <Border Grid.Row="3" Background="White" BorderBrush="#ddd" BorderThickness="0,1,0,0" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Ausgabe Checkbox -->
                <CheckBox x:Name="chkAusgabe" Content="Ausgabe" VerticalAlignment="Center"/>

                <!-- Status Text -->
                <TextBlock x:Name="txtStatus" Grid.Column="1" Text="" Foreground="#666"
                           VerticalAlignment="Center" Margin="20,0,0,0"/>

                <!-- Buttons -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Content="Lieferschein" Click="Lieferschein_Click" Padding="12,8" Margin="0,0,5,0"/>
                    <Button Content="Rechnung" Click="Rechnung_Click" Padding="12,8" Margin="0,0,5,0"
                            ToolTip="Rechnung erstellen (Lieferschein erforderlich)"/>
                    <Button Content="Rechnung (DL)" Click="RechnungOhneVersand_Click" Padding="12,8" Margin="0,0,5,0"
                            Background="#17a2b8" Foreground="White" BorderThickness="0"
                            ToolTip="Dienstleistungsrechnung ohne Lieferschein/Versand"/>
                    <Button x:Name="btnLieferantenbestellung" Content="Lieferantenbestellung" Click="Lieferantenbestellung_Click"
                            Padding="12,8" Margin="0,0,5,0" Background="#ffc107" Foreground="#333" BorderThickness="0"
                            ToolTip="Erstellt eine Lieferantenbestellung aus diesem Auftrag"/>
                    <Button Content="Speichern" Click="Speichern_Click" Padding="15,8" Margin="0,0,5,0"
                            Background="#0078D4" Foreground="White" BorderThickness="0"/>
                    <Button Content="Abbrechen" Click="Zurueck_Click" Padding="12,8"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>

<Window x:Class="NovviaERP.WPF.Views.WareneingangDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Wareneingang buchen" Height="600" Width="900"
        WindowStartupLocation="CenterOwner" Background="#f0f2f5">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,15">
            <TextBlock Text="Wareneingang" FontSize="24" FontWeight="Bold"/>
            <TextBlock x:Name="txtBestellNr" FontSize="24" Margin="10,0,0,0" Foreground="{DynamicResource PrimaryBrush}"/>
        </StackPanel>

        <!-- Lieferant + Datum -->
        <Border Grid.Row="1" Background="White" CornerRadius="6" Padding="15" Margin="0,0,0,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Lieferant:" FontWeight="SemiBold" VerticalAlignment="Center"/>
                <TextBlock x:Name="txtLieferant" Grid.Column="1" VerticalAlignment="Center" Margin="10,0,0,0"/>
                <TextBlock Text="Eingangsdatum:" Grid.Column="2" FontWeight="SemiBold" VerticalAlignment="Center" Margin="30,0,0,0"/>
                <DatePicker x:Name="dpEingangsdatum" Grid.Column="3" Margin="10,0,0,0"/>
                <TextBlock Text="Lieferschein-Nr:" Grid.Column="4" FontWeight="SemiBold" VerticalAlignment="Center" Margin="30,0,0,0"/>
                <TextBox x:Name="txtLieferscheinNr" Grid.Column="5" Height="28" Margin="10,0,0,0" VerticalContentAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Positionen -->
        <Border Grid.Row="2" Background="White" CornerRadius="6" Padding="15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Text="Positionen - Gelieferte Mengen eintragen:" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                <DataGrid x:Name="dgPositionen" Grid.Row="1" AutoGenerateColumns="False" CanUserAddRows="False"
                          SelectionMode="Single" GridLinesVisibility="All" AlternatingRowBackground="#f9f9f9">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Art-Nr." Binding="{Binding CArtNr}" Width="100" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Bezeichnung" Binding="{Binding CName}" Width="*" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Bestellt" Binding="{Binding FMenge, StringFormat=N2}" Width="80" IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                    <Setter Property="Background" Value="#E3F2FD"/>
                                    <Setter Property="Padding" Value="5,2"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Bereits gelief." Binding="{Binding FMengeGeliefert, StringFormat=N2}" Width="90" IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                    <Setter Property="Background" Value="#C8E6C9"/>
                                    <Setter Property="Padding" Value="5,2"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Offen" Binding="{Binding Offen, StringFormat=N2}" Width="80" IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                    <Setter Property="Foreground" Value="#dc3545"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Jetzt geliefert" Binding="{Binding JetztGeliefert, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                    <Setter Property="Background" Value="#FFF3E0"/>
                                    <Setter Property="Padding" Value="5,2"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                            <DataGridTextColumn.EditingElementStyle>
                                <Style TargetType="TextBox">
                                    <Setter Property="Background" Value="#FFF3E0"/>
                                </Style>
                            </DataGridTextColumn.EditingElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Chargen-Nr" Binding="{Binding ChargenNr, Mode=TwoWay}" Width="100"/>
                        <DataGridTemplateColumn Header="MHD" Width="110">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding MHD, StringFormat=dd.MM.yyyy}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <DatePicker SelectedDate="{Binding MHD}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- Schnellaktionen -->
        <Border Grid.Row="3" Background="White" CornerRadius="6" Padding="15" Margin="0,15,0,0">
            <StackPanel Orientation="Horizontal">
                <Button Content="Alle vollstaendig" Click="AlleVollstaendig_Click" Padding="15,5" Margin="0,0,10,0"/>
                <Button Content="Alle auf 0" Click="AlleNull_Click" Padding="15,5" Margin="0,0,10,0"/>
                <TextBlock Text="Hinweis: Teillieferungen sind moeglich. Nicht gelieferte Mengen bleiben offen."
                           Foreground="#666" VerticalAlignment="Center" Margin="20,0,0,0"/>
            </StackPanel>
        </Border>

        <!-- Footer -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Wareneingang buchen" Width="180" Height="35" Click="Buchen_Click"
                    Background="#28a745" Foreground="White" FontWeight="Bold"/>
            <Button Content="Abbrechen" Width="100" Height="35" Margin="15,0,0,0" Click="Abbrechen_Click"/>
        </StackPanel>
    </Grid>
</Window>

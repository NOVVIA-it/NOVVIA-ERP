<UserControl x:Class="NovviaERP.WPF.Views.EinstellungenView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#f0f2f5">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Einstellungen" FontSize="28" FontWeight="Bold"/>

        <TabControl Grid.Row="1" Margin="0,15,0,0">
            <!-- Firmendaten Tab -->
            <TabItem Header="Firmendaten">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="Firmendaten" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Firma:" VerticalAlignment="Center" Grid.Row="0"/>
                            <TextBox x:Name="txtFirmaName" Grid.Row="0" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Zusatz:" VerticalAlignment="Center" Grid.Row="0" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaZusatz" Grid.Row="0" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="Strasse:" VerticalAlignment="Center" Grid.Row="1"/>
                            <TextBox x:Name="txtFirmaStrasse" Grid.Row="1" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Hausnummer:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaHausnr" Grid.Row="1" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="PLZ:" VerticalAlignment="Center" Grid.Row="2"/>
                            <TextBox x:Name="txtFirmaPLZ" Grid.Row="2" Grid.Column="1" Width="100" HorizontalAlignment="Left" Margin="0,3"/>

                            <TextBlock Text="Ort:" VerticalAlignment="Center" Grid.Row="2" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaOrt" Grid.Row="2" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="Land:" VerticalAlignment="Center" Grid.Row="3"/>
                            <TextBox x:Name="txtFirmaLand" Grid.Row="3" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Telefon:" VerticalAlignment="Center" Grid.Row="4"/>
                            <TextBox x:Name="txtFirmaTelefon" Grid.Row="4" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Fax:" VerticalAlignment="Center" Grid.Row="4" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaFax" Grid.Row="4" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="E-Mail:" VerticalAlignment="Center" Grid.Row="5"/>
                            <TextBox x:Name="txtFirmaEmail" Grid.Row="5" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Website:" VerticalAlignment="Center" Grid.Row="5" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaWebsite" Grid.Row="5" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="USt-IdNr:" VerticalAlignment="Center" Grid.Row="6"/>
                            <TextBox x:Name="txtFirmaUstId" Grid.Row="6" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Steuernummer:" VerticalAlignment="Center" Grid.Row="6" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaSteuerNr" Grid.Row="6" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="Handelsregister:" VerticalAlignment="Center" Grid.Row="7"/>
                            <TextBox x:Name="txtFirmaHReg" Grid.Row="7" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Geschaeftsfuehrer:" VerticalAlignment="Center" Grid.Row="7" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaGF" Grid.Row="7" Grid.Column="4" Margin="0,3"/>
                        </Grid>

                        <!-- Bankverbindung -->
                        <TextBlock Text="Bankverbindung" FontSize="16" FontWeight="SemiBold" Margin="0,20,0,10"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Bank:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtFirmaBank" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="BIC:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaBIC" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="IBAN:" VerticalAlignment="Center" Grid.Row="1"/>
                            <TextBox x:Name="txtFirmaIBAN" Grid.Row="1" Grid.Column="1" Margin="0,3"/>
                        </Grid>

                        <Button Content="Firmendaten speichern" Width="180" HorizontalAlignment="Left" Margin="0,20,0,0" Click="FirmaSpeichern_Click"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Kundengruppen Tab -->
            <TabItem Header="Kundengruppen">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="KundengruppeNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="KundengruppeBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="KundengruppeLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgKundengruppen" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KKundenGruppe}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Rabatt %" Binding="{Binding FRabatt, StringFormat=N2}" Width="80"/>
                            <DataGridTextColumn Header="Netto-Preise" Binding="{Binding NNettoPreise}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Bearbeitungsbereich -->
                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtKGName" Grid.Column="1"/>

                            <TextBlock Text="Rabatt %:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtKGRabatt" Grid.Column="4" Width="80" HorizontalAlignment="Left"/>

                            <Button Content="Speichern" Grid.Column="5" Width="100" HorizontalAlignment="Left" Click="KundengruppeSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Kundenkategorien Tab -->
            <TabItem Header="Kundenkategorien">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="KundenkategorieNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="KundenkategorieBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="KundenkategorieLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgKundenkategorien" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KKundenKategorie}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="250"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="250"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtKKName" Grid.Column="1"/>
                            <Button Content="Speichern" Grid.Column="2" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="KundenkategorieSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Zahlungsarten Tab -->
            <TabItem Header="Zahlungsarten">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="ZahlungsartNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="ZahlungsartBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="ZahlungsartLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgZahlungsarten" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KZahlungsart}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Modul" Binding="{Binding CModulId}" Width="150"/>
                            <DataGridCheckBoxColumn Header="Aktiv" Binding="{Binding NAktiv}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtZAName" Grid.Column="1"/>

                            <TextBlock Text="Modul:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtZAModul" Grid.Column="4"/>

                            <Button Content="Speichern" Grid.Column="5" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="ZahlungsartSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Versandarten Tab -->
            <TabItem Header="Versandarten">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="VersandartNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="VersandartBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="VersandartLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgVersandarten" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KVersandart}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Lieferzeit" Binding="{Binding CLieferzeitText}" Width="150"/>
                            <DataGridTextColumn Header="Kosten" Binding="{Binding FKosten, StringFormat=N2}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtVAName" Grid.Column="1"/>

                            <TextBlock Text="Kosten:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtVAKosten" Grid.Column="4"/>

                            <Button Content="Speichern" Grid.Column="5" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="VersandartSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Zahlungsanbieter Tab -->
            <TabItem Header="Zahlungsanbieter">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <!-- PayPal -->
                        <TextBlock Text="PayPal" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Client ID:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtPayPalClientId" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Secret:" VerticalAlignment="Center" Grid.Row="1"/>
                            <PasswordBox x:Name="txtPayPalSecret" Grid.Row="1" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Return URL:" VerticalAlignment="Center" Grid.Row="2"/>
                            <TextBox x:Name="txtPayPalReturnUrl" Grid.Row="2" Grid.Column="1" Margin="0,3" Text="https://novvia.de/zahlung/erfolg"/>

                            <TextBlock Text="Cancel URL:" VerticalAlignment="Center" Grid.Row="3"/>
                            <TextBox x:Name="txtPayPalCancelUrl" Grid.Row="3" Grid.Column="1" Margin="0,3" Text="https://novvia.de/zahlung/abbruch"/>

                            <CheckBox x:Name="chkPayPalSandbox" Content="Sandbox-Modus (Test)" Grid.Row="4" Grid.Column="1" Margin="0,8"/>
                        </Grid>

                        <!-- Mollie -->
                        <TextBlock Text="Mollie" FontSize="18" FontWeight="SemiBold" Margin="0,25,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="API Key:" VerticalAlignment="Center"/>
                            <PasswordBox x:Name="txtMollieApiKey" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Redirect URL:" VerticalAlignment="Center" Grid.Row="1"/>
                            <TextBox x:Name="txtMollieRedirectUrl" Grid.Row="1" Grid.Column="1" Margin="0,3" Text="https://novvia.de/zahlung/erfolg"/>

                            <TextBlock Text="Webhook URL:" VerticalAlignment="Center" Grid.Row="2"/>
                            <TextBox x:Name="txtMollieWebhookUrl" Grid.Row="2" Grid.Column="1" Margin="0,3" Text="https://novvia.de/api/mollie/webhook"/>
                        </Grid>

                        <!-- Allgemein -->
                        <TextBlock Text="Allgemein" FontSize="18" FontWeight="SemiBold" Margin="0,25,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="350"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Firmenname:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtPaymentFirmaName" Grid.Column="1" Margin="0,3"/>
                        </Grid>

                        <StackPanel Orientation="Horizontal" Margin="0,25,0,0">
                            <Button Content="Zahlungsanbieter speichern" Width="200" Click="ZahlungsanbieterSpeichern_Click"
                                    Background="#0078D4" Foreground="White" Padding="10,8"/>
                            <Button Content="Verbindung testen" Width="150" Click="ZahlungsanbieterTesten_Click" Margin="15,0,0,0" Padding="10,8"/>
                        </StackPanel>

                        <TextBlock x:Name="txtPaymentStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>

                        <!-- Zahlungsabgleich Einstellungen -->
                        <TextBlock Text="Zahlungsabgleich" FontSize="18" FontWeight="SemiBold" Margin="0,35,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Auto-Match Schwelle (%):" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtAutoMatchSchwelle" Grid.Column="1" Margin="0,3" Text="90"/>
                            <TextBlock Grid.Column="2" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="Gray"
                                       Text="Zahlungen mit Konfidenz >= Schwelle werden automatisch zugeordnet"/>

                            <Button Grid.Row="1" Grid.ColumnSpan="2" Content="Zahlungsabgleich-Einstellungen speichern"
                                    Click="ZahlungsabgleichEinstellungenSpeichern_Click" Margin="0,15,0,0" Padding="15,8"/>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- WooCommerce Shops Tab -->
            <TabItem Header="WooCommerce Shops">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="+ Neuer Shop" Click="WooShopNeu_Click" Padding="10,5" Margin="0,0,10,0"/>
                        <Button Content="Verbindung testen" Click="WooShopTest_Click" Padding="10,5" Margin="0,0,10,0"/>
                        <Button Content="Webhooks einrichten" Click="WooShopWebhooks_Click" Padding="10,5" Margin="0,0,10,0"/>
                        <CheckBox x:Name="chkWooTestModus" Content="Testmodus (alles loggen)" VerticalAlignment="Center" Margin="20,0,0,0"/>
                    </StackPanel>

                    <DataGrid x:Name="dgWooShops" Grid.Row="1" AutoGenerateColumns="False"
                              SelectionMode="Single" CanUserAddRows="False" SelectionChanged="DgWooShops_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Shop-URL" Binding="{Binding Url}" Width="250"/>
                            <DataGridTextColumn Header="Consumer Key" Binding="{Binding ConsumerKey}" Width="200"/>
                            <DataGridCheckBoxColumn Header="Aktiv" Binding="{Binding Aktiv}" Width="60"/>
                            <DataGridCheckBoxColumn Header="Webhooks" Binding="{Binding WebhooksAktiv}" Width="80"/>
                            <DataGridTextColumn Header="Sync-Intervall (Min)" Binding="{Binding SyncIntervallMinuten}" Width="120"/>
                            <DataGridTextColumn Header="Letzter Sync" Binding="{Binding LetzterSync, StringFormat=dd.MM.yyyy HH:mm}" Width="140" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <GroupBox Header="Shop-Details" Padding="10" Width="400">
                            <StackPanel>
                                <TextBlock Text="Consumer Secret:" Margin="0,0,0,5"/>
                                <PasswordBox x:Name="txtWooSecret" Width="350" HorizontalAlignment="Left"/>
                                <TextBlock Text="Webhook Secret:" Margin="0,10,0,5"/>
                                <TextBox x:Name="txtWooWebhookSecret" Width="350" IsReadOnly="True"/>
                                <TextBlock Text="Webhook Callback URL:" Margin="0,10,0,5"/>
                                <TextBox x:Name="txtWooCallbackUrl" Width="350" ToolTip="https://ihre-domain.de"/>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Aktionen" Padding="10" Margin="15,0,0,0" Width="250">
                            <StackPanel>
                                <Button Content="Shop speichern" Click="WooShopSpeichern_Click" Margin="0,0,0,10" Padding="10,5"/>
                                <Button Content="Shop loeschen" Click="WooShopLoeschen_Click" Margin="0,0,0,10" Padding="10,5" Background="#dc3545" Foreground="White"/>
                                <Separator Margin="0,10"/>
                                <TextBlock Text="Sync starten:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <Button Content="Kategorien sync" Click="WooSyncKategorien_Click" Margin="0,0,0,5" Padding="10,5"/>
                                <Button Content="Artikel sync" Click="WooSyncArtikel_Click" Margin="0,0,0,5" Padding="10,5"/>
                                <Button Content="Bestellungen import" Click="WooImportBestellungen_Click" Padding="10,5"/>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="API-Log (Testmodus)" Padding="10" Margin="15,0,0,0" Width="350">
                            <ScrollViewer MaxHeight="200">
                                <TextBox x:Name="txtWooApiLog" IsReadOnly="True" TextWrapping="Wrap"
                                         FontFamily="Consolas" FontSize="11" AcceptsReturn="True"/>
                            </ScrollViewer>
                        </GroupBox>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Steuern Tab -->
            <TabItem Header="Steuern">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Steuersaetze (nur Ansicht - Aenderungen in JTL-Wawi)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                    <DataGrid x:Name="dgSteuern" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KSteuer}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Steuersatz %" Binding="{Binding FSteuersatz, StringFormat=N2}" Width="100"/>
                            <DataGridTextColumn Header="Land" Binding="{Binding CISO}" Width="60"/>
                            <DataGridTextColumn Header="Standard" Binding="{Binding NStandard}" Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Konten Tab -->
            <TabItem Header="Konten">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Sachkonten (nur Ansicht - Aenderungen in JTL-Wawi)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                    <DataGrid x:Name="dgKonten" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Kontonr" Binding="{Binding CKontoNr}" Width="100"/>
                            <DataGridTextColumn Header="Bezeichnung" Binding="{Binding CName}" Width="250"/>
                            <DataGridTextColumn Header="Typ" Binding="{Binding CTyp}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Eigene Felder Tab -->
            <TabItem Header="Eigene Felder">
                <TabControl Margin="10">
                    <!-- Lieferant Eigene Felder (NOVVIA) -->
                    <TabItem Header="Lieferant">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="Neu" Width="80" Click="LieferantAttributNeu_Click" Margin="0,0,5,0"/>
                                <Button Content="Bearbeiten" Width="80" Click="LieferantAttributBearbeiten_Click" Margin="0,0,5,0"/>
                                <Button Content="Loeschen" Width="80" Click="LieferantAttributLoeschen_Click"/>
                                <TextBlock x:Name="txtLieferantHinweis" Text="" VerticalAlignment="Center" Foreground="Orange" Margin="15,0,0,0"/>
                            </StackPanel>

                            <DataGrid x:Name="dgLieferantAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="50"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                    <DataGridTextColumn Header="Sort" Binding="{Binding NSortierung}" Width="60"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <!-- Bearbeitungsbereich -->
                            <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="180"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="90"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Name:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtLiefAttrName" Grid.Column="1"/>

                                    <TextBlock Text="Beschreibung:" VerticalAlignment="Center" Grid.Column="3"/>
                                    <TextBox x:Name="txtLiefAttrBeschr" Grid.Column="4"/>

                                    <TextBlock Text="Typ:" VerticalAlignment="Center" Grid.Column="6"/>
                                    <ComboBox x:Name="cmbLiefAttrTyp" Grid.Column="7" SelectedIndex="0">
                                        <ComboBoxItem Content="Text" Tag="3"/>
                                        <ComboBoxItem Content="Ganzzahl" Tag="1"/>
                                        <ComboBoxItem Content="Dezimal" Tag="2"/>
                                        <ComboBoxItem Content="Datum" Tag="4"/>
                                    </ComboBox>

                                    <TextBlock Text="Sort:" VerticalAlignment="Center" Grid.Column="9"/>
                                    <TextBox x:Name="txtLiefAttrSort" Grid.Column="10" Text="0"/>

                                    <Button Content="Speichern" Grid.Column="11" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="LieferantAttributSpeichern_Click"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </TabItem>

                    <!-- Kunde Attribute (JTL - nur Ansicht) -->
                    <TabItem Header="Kunde">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Kunden-Attribute (JTL-Wawi - nur Ansicht, Aenderungen ueber Kunde.spKundenEigenesFeldCreateOrUpdate)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                            <DataGrid x:Name="dgKundeAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="60"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>

                    <!-- Artikel Attribute (JTL - nur Ansicht) -->
                    <TabItem Header="Artikel">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Artikel-Attribute / Freifelder (JTL-Wawi - nur Ansicht)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                            <DataGrid x:Name="dgArtikelAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="60"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>

                    <!-- Auftrag Attribute (JTL - nur Ansicht) -->
                    <TabItem Header="Auftrag">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Auftrags-Attribute / Freifelder (JTL-Wawi - nur Ansicht)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                            <DataGrid x:Name="dgAuftragAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="60"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>

                    <!-- Firma Eigene Felder (JTL) -->
                    <TabItem Header="Firma">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Firma Attribute (Definitionen aus JTL-Wawi)" FontWeight="SemiBold" Margin="0,0,0,5"/>

                            <DataGrid x:Name="dgFirmaAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False" MaxHeight="200">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="50"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="200"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <TextBlock Grid.Row="2" Text="Firma Eigene Felder (Werte)" FontWeight="SemiBold" Margin="0,10,0,5"/>

                            <DataGrid x:Name="dgFirmaEigeneFelder" Grid.Row="3" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Attribut" Binding="{Binding CAttributName}" Width="250"/>
                                    <DataGridTextColumn Header="Wert" Binding="{Binding WertAnzeige}" Width="200"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding NFeldTyp}" Width="60"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>

            <!-- Protokoll Tab -->
            <TabItem Header="Protokoll">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Statistik-Karten -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <Border Background="#e3f2fd" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Gesamt (7 Tage)" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogGesamt" Text="0" FontSize="20" FontWeight="Bold" Foreground="#1976d2"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#e8f5e9" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Shop" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogShop" Text="0" FontSize="20" FontWeight="Bold" Foreground="#388e3c"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#fff3e0" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Zahlungsabgleich" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogZahlung" Text="0" FontSize="20" FontWeight="Bold" Foreground="#f57c00"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#e1f5fe" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Stammdaten" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogStamm" Text="0" FontSize="20" FontWeight="Bold" Foreground="#0288d1"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#f3e5f5" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Bewegungsdaten" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogBewegung" Text="0" FontSize="20" FontWeight="Bold" Foreground="#7b1fa2"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#ffebee" CornerRadius="5" Padding="15,10">
                            <StackPanel>
                                <TextBlock Text="Fehler" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogFehler" Text="0" FontSize="20" FontWeight="Bold" Foreground="#c62828"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Filter -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Kategorie:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="cmbLogKategorie" Width="150" Margin="0,0,15,0" SelectionChanged="LogFilter_Changed">
                            <ComboBoxItem Content="(Alle)" IsSelected="True"/>
                            <ComboBoxItem Content="Shop"/>
                            <ComboBoxItem Content="Zahlungsabgleich"/>
                            <ComboBoxItem Content="Stammdaten"/>
                            <ComboBoxItem Content="Bewegungsdaten"/>
                            <ComboBoxItem Content="Fehler"/>
                        </ComboBox>

                        <TextBlock Text="Modul:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="cmbLogModul" Width="150" Margin="0,0,15,0" SelectionChanged="LogFilter_Changed">
                            <ComboBoxItem Content="(Alle)" IsSelected="True"/>
                        </ComboBox>

                        <TextBlock Text="Von:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <DatePicker x:Name="dpLogVon" Width="120" Margin="0,0,15,0" SelectedDateChanged="LogFilter_Changed"/>

                        <TextBlock Text="Bis:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <DatePicker x:Name="dpLogBis" Width="120" Margin="0,0,15,0" SelectedDateChanged="LogFilter_Changed"/>

                        <TextBlock Text="Suche:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox x:Name="txtLogSuche" Width="200" Margin="0,0,15,0"/>

                        <Button Content="Suchen" Click="LogSuchen_Click" Padding="15,5" Margin="0,0,10,0"/>
                        <Button Content="Aktualisieren" Click="LogAktualisieren_Click" Padding="15,5"/>
                    </StackPanel>

                    <!-- Log-Tabelle -->
                    <DataGrid x:Name="dgLogs" Grid.Row="2" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False" RowHeight="28"
                              SelectionChanged="DgLogs_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Zeitpunkt" Binding="{Binding ZeitpunktAnzeige}" Width="140"/>
                            <DataGridTextColumn Header="Kategorie" Binding="{Binding CKategorie}" Width="110"/>
                            <DataGridTextColumn Header="Modul" Binding="{Binding CModul}" Width="120"/>
                            <DataGridTextColumn Header="Aktion" Binding="{Binding CAktion}" Width="130"/>
                            <DataGridTextColumn Header="Entity" Binding="{Binding CEntityNr}" Width="100"/>
                            <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="*"/>
                            <DataGridTextColumn Header="Benutzer" Binding="{Binding CBenutzerName}" Width="100"/>
                        </DataGrid.Columns>
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding NSeverity}" Value="3">
                                        <Setter Property="Background" Value="#ffebee"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding NSeverity}" Value="2">
                                        <Setter Property="Background" Value="#fff3e0"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>

                    <!-- Detail-Bereich -->
                    <Border Grid.Row="3" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Feld:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogFeld" Text="-" Margin="0,0,20,0"/>
                                <TextBlock Text="Alter Wert:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogAlterWert" Text="-" Margin="0,0,20,0" Foreground="#c62828"/>
                                <TextBlock Text="Neuer Wert:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogNeuerWert" Text="-" Foreground="#388e3c"/>
                            </StackPanel>

                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,5,0,0">
                                <TextBlock Text="Details:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogDetails" Text="-" TextWrapping="Wrap" MaxWidth="800"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Top">
                                <TextBlock Text="Rechner:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogRechner" Text="-" Margin="0,0,15,0"/>
                                <TextBlock Text="IP:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogIP" Text="-"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>

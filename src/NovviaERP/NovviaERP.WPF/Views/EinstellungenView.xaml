<UserControl x:Class="NovviaERP.WPF.Views.EinstellungenView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:base="clr-namespace:NovviaERP.WPF.Controls.Base"
             Background="#f0f2f5">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Einstellungen" FontSize="28" FontWeight="Bold"/>

        <TabControl x:Name="mainTabs" Grid.Row="1" Margin="0,15,0,0" SelectionChanged="MainTabs_SelectionChanged">
            <!-- Firmendaten Tab -->
            <TabItem Header="Firmendaten">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="Firmendaten" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Firma:" VerticalAlignment="Center" Grid.Row="0"/>
                            <TextBox x:Name="txtFirmaName" Grid.Row="0" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Zusatz:" VerticalAlignment="Center" Grid.Row="0" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaZusatz" Grid.Row="0" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="Strasse:" VerticalAlignment="Center" Grid.Row="1"/>
                            <TextBox x:Name="txtFirmaStrasse" Grid.Row="1" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Hausnummer:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaHausnr" Grid.Row="1" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="PLZ:" VerticalAlignment="Center" Grid.Row="2"/>
                            <TextBox x:Name="txtFirmaPLZ" Grid.Row="2" Grid.Column="1" Width="100" HorizontalAlignment="Left" Margin="0,3"/>

                            <TextBlock Text="Ort:" VerticalAlignment="Center" Grid.Row="2" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaOrt" Grid.Row="2" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="Land:" VerticalAlignment="Center" Grid.Row="3"/>
                            <TextBox x:Name="txtFirmaLand" Grid.Row="3" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Telefon:" VerticalAlignment="Center" Grid.Row="4"/>
                            <TextBox x:Name="txtFirmaTelefon" Grid.Row="4" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Fax:" VerticalAlignment="Center" Grid.Row="4" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaFax" Grid.Row="4" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="E-Mail:" VerticalAlignment="Center" Grid.Row="5"/>
                            <TextBox x:Name="txtFirmaEmail" Grid.Row="5" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Website:" VerticalAlignment="Center" Grid.Row="5" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaWebsite" Grid.Row="5" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="USt-IdNr:" VerticalAlignment="Center" Grid.Row="6"/>
                            <TextBox x:Name="txtFirmaUstId" Grid.Row="6" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Steuernummer:" VerticalAlignment="Center" Grid.Row="6" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaSteuerNr" Grid.Row="6" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="Handelsregister:" VerticalAlignment="Center" Grid.Row="7"/>
                            <TextBox x:Name="txtFirmaHReg" Grid.Row="7" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Geschaeftsfuehrer:" VerticalAlignment="Center" Grid.Row="7" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaGF" Grid.Row="7" Grid.Column="4" Margin="0,3"/>
                        </Grid>

                        <!-- Bankverbindung -->
                        <TextBlock Text="Bankverbindung" FontSize="16" FontWeight="SemiBold" Margin="0,20,0,10"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Bank:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtFirmaBank" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="BIC:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtFirmaBIC" Grid.Column="4" Margin="0,3"/>

                            <TextBlock Text="IBAN:" VerticalAlignment="Center" Grid.Row="1"/>
                            <TextBox x:Name="txtFirmaIBAN" Grid.Row="1" Grid.Column="1" Margin="0,3"/>
                        </Grid>

                        <Button Content="Firmendaten speichern" Width="180" HorizontalAlignment="Left" Margin="0,20,0,0" Click="FirmaSpeichern_Click"/>

                        <!-- Firma Eigene Felder / Einstellungen -->
                        <TextBlock Text="Eigene Felder / Einstellungen" FontSize="16" FontWeight="SemiBold" Margin="0,30,0,10"/>
                        <TextBlock Text="Hier werden alle NOVVIA-Einstellungen als eigene Felder angezeigt." FontSize="11" Foreground="Gray" Margin="0,0,0,10"/>

                        <DataGrid x:Name="dgFirmaEinstellungen" Height="200" AutoGenerateColumns="False" IsReadOnly="False"
                                  CanUserAddRows="False" CanUserDeleteRows="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Schluessel" Binding="{Binding CSchluessel}" Width="250" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Wert" Binding="{Binding CWert}" Width="150"/>
                                <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="300"/>
                                <DataGridTextColumn Header="Geaendert" Binding="{Binding DGeaendert, StringFormat='{}{0:dd.MM.yyyy HH:mm}'}" Width="130" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                            <Button Content="Neues Feld" Width="100" Click="FirmaEinstellungNeu_Click" Margin="0,0,10,0"/>
                            <Button Content="Speichern" Width="100" Click="FirmaEinstellungenSpeichern_Click"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Kundengruppen Tab -->
            <TabItem Header="Kundengruppen">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="KundengruppeNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="KundengruppeBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="KundengruppeLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgKundengruppen" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KKundenGruppe}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Rabatt %" Binding="{Binding FRabatt, StringFormat=N2}" Width="80"/>
                            <DataGridTextColumn Header="Netto-Preise" Binding="{Binding NNettoPreise}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Bearbeitungsbereich -->
                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtKGName" Grid.Column="1"/>

                            <TextBlock Text="Rabatt %:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtKGRabatt" Grid.Column="4" Width="80" HorizontalAlignment="Left"/>

                            <Button Content="Speichern" Grid.Column="5" Width="100" HorizontalAlignment="Left" Click="KundengruppeSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Kundenkategorien Tab -->
            <TabItem Header="Kundenkategorien">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="KundenkategorieNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="KundenkategorieBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="KundenkategorieLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgKundenkategorien" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KKundenKategorie}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="250"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="250"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtKKName" Grid.Column="1"/>
                            <Button Content="Speichern" Grid.Column="2" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="KundenkategorieSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Zahlungsarten Tab -->
            <TabItem Header="Zahlungsarten">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="ZahlungsartNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="ZahlungsartBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="ZahlungsartLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgZahlungsarten" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KZahlungsart}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Modul" Binding="{Binding CModulId}" Width="150"/>
                            <DataGridCheckBoxColumn Header="Aktiv" Binding="{Binding NAktiv}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtZAName" Grid.Column="1"/>

                            <TextBlock Text="Modul:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtZAModul" Grid.Column="4"/>

                            <Button Content="Speichern" Grid.Column="5" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="ZahlungsartSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Versandarten Tab -->
            <TabItem Header="Versandarten">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Neu" Width="80" Click="VersandartNeu_Click" Margin="0,0,5,0"/>
                        <Button Content="Bearbeiten" Width="80" Click="VersandartBearbeiten_Click" Margin="0,0,5,0"/>
                        <Button Content="Loeschen" Width="80" Click="VersandartLoschen_Click"/>
                    </StackPanel>

                    <DataGrid x:Name="dgVersandarten" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KVersandart}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Lieferzeit" Binding="{Binding CLieferzeitText}" Width="150"/>
                            <DataGridTextColumn Header="Kosten" Binding="{Binding FKosten, StringFormat=N2}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtVAName" Grid.Column="1"/>

                            <TextBlock Text="Kosten:" VerticalAlignment="Center" Grid.Column="3"/>
                            <TextBox x:Name="txtVAKosten" Grid.Column="4"/>

                            <Button Content="Speichern" Grid.Column="5" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="VersandartSpeichern_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Lager Tab (JTL-Style: Lager anlegen/bearbeiten) -->
            <TabItem Header="Lager">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="350"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Linke Seite: Lager-Liste -->
                    <Border BorderBrush="#ddd" BorderThickness="0,0,1,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Toolbar -->
                            <StackPanel Orientation="Horizontal" Margin="10,10,10,5">
                                <Button Content="Anlegen" Click="LagerNeu_Click" Padding="12,6" Margin="0,0,8,0"
                                        Background="{DynamicResource PrimaryBrush}" Foreground="White"/>
                                <Button x:Name="btnLagerLoeschen" Content="Loeschen" Click="LagerLoeschen_Click" Padding="12,6"
                                        IsEnabled="False"/>
                            </StackPanel>

                            <!-- Lager-Liste mit persistenter Markierung -->
                            <ListBox x:Name="lstLager" Grid.Row="1" Margin="10,5,10,10"
                                     DisplayMemberPath="CName" SelectedValuePath="KWarenLager"
                                     SelectionChanged="LstLager_SelectionChanged">
                                <ListBox.Resources>
                                    <!-- Markierung bleibt sichtbar auch wenn ListBox nicht fokussiert -->
                                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="{DynamicResource PrimaryColor}"/>
                                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>
                                </ListBox.Resources>
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Padding" Value="10,6"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                            </ListBox>
                        </Grid>
                    </Border>

                    <!-- Rechte Seite: Lager-Details (JTL-Style) -->
                    <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="20,15">

                            <!-- Allgemeine Informationen -->
                            <TextBlock Text="Allgemein" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="250"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Name:" VerticalAlignment="Center"/>
                                <TextBox x:Name="txtLagerName" Grid.Column="1"/>

                                <TextBlock Text="Kuerzel:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                <TextBox x:Name="txtLagerKuerzel" Grid.Row="1" Grid.Column="1" Margin="0,8,0,0" MaxLength="10"/>

                                <TextBlock Text="Typ des Warenlagers:" VerticalAlignment="Center" Grid.Row="2" Margin="0,8,0,0"/>
                                <ComboBox x:Name="cmbLagerTyp" Grid.Row="2" Grid.Column="1" Margin="0,8,0,0">
                                    <ComboBoxItem Content="Standard" Tag="Standard" IsSelected="True"/>
                                    <ComboBoxItem Content="WMS-Lager" Tag="WMS"/>
                                    <ComboBoxItem Content="FBA-Lager" Tag="FBA"/>
                                    <ComboBoxItem Content="Fulfillment-Lager" Tag="Fulfillment"/>
                                    <ComboBoxItem Content="Konsignationslager" Tag="Konsignation"/>
                                </ComboBox>
                            </Grid>

                            <!-- Optionen -->
                            <TextBlock Text="Optionen" FontSize="16" FontWeight="SemiBold" Margin="0,25,0,15"/>
                            <StackPanel>
                                <CheckBox x:Name="chkLagerAktiv" Content="Lager ist aktiv" IsChecked="True" Margin="0,0,0,8"/>
                            </StackPanel>

                            <!-- Adresse -->
                            <TextBlock Text="Lageranschrift" FontSize="16" FontWeight="SemiBold" Margin="0,20,0,15"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="300"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Strasse:" VerticalAlignment="Center"/>
                                <TextBox x:Name="txtLagerStrasse" Grid.Column="1"/>

                                <TextBlock Text="PLZ/Ort:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.Column="1" Margin="0,8,0,0">
                                    <TextBox x:Name="txtLagerPLZ" Width="80" MaxLength="10"/>
                                    <TextBox x:Name="txtLagerOrt" Width="212" Margin="8,0,0,0"/>
                                </StackPanel>

                                <TextBlock Text="Land:" VerticalAlignment="Center" Grid.Row="2" Margin="0,8,0,0"/>
                                <TextBox x:Name="txtLagerLand" Grid.Row="2" Grid.Column="1" Margin="0,8,0,0" Text="Deutschland"/>

                                <TextBlock Text="Telefon:" VerticalAlignment="Center" Grid.Row="3" Margin="0,8,0,0"/>
                                <TextBox x:Name="txtLagerTelefon" Grid.Row="3" Grid.Column="1" Margin="0,8,0,0"/>

                                <TextBlock Text="E-Mail:" VerticalAlignment="Center" Grid.Row="4" Margin="0,8,0,0"/>
                                <TextBox x:Name="txtLagerEmail" Grid.Row="4" Grid.Column="1" Margin="0,8,0,0"/>
                            </Grid>

                            <!-- Ansprechpartner -->
                            <TextBlock Text="Ansprechpartner" FontSize="16" FontWeight="SemiBold" Margin="0,20,0,15"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="300"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Name:" VerticalAlignment="Center"/>
                                <TextBox x:Name="txtLagerAnsprechpartner" Grid.Column="1"/>
                            </Grid>

                            <!-- Speichern -->
                            <StackPanel Orientation="Horizontal" Margin="0,25,0,0">
                                <Button Content="Speichern" Click="LagerSpeichern_Click" Padding="20,8"
                                        Background="{DynamicResource PrimaryBrush}" Foreground="White" FontWeight="SemiBold"/>
                                <Button Content="Lagerplaetze verwalten" Click="LagerplaetzeVerwalten_Click" Padding="15,8" Margin="15,0,0,0"/>
                            </StackPanel>

                            <TextBlock x:Name="txtLagerStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <!-- Zahlungsanbieter Tab -->
            <TabItem Header="Zahlungsanbieter">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <!-- PayPal -->
                        <TextBlock Text="PayPal" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Client ID:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtPayPalClientId" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Secret:" VerticalAlignment="Center" Grid.Row="1"/>
                            <PasswordBox x:Name="txtPayPalSecret" Grid.Row="1" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Return URL:" VerticalAlignment="Center" Grid.Row="2"/>
                            <TextBox x:Name="txtPayPalReturnUrl" Grid.Row="2" Grid.Column="1" Margin="0,3" Text="https://novvia.de/zahlung/erfolg"/>

                            <TextBlock Text="Cancel URL:" VerticalAlignment="Center" Grid.Row="3"/>
                            <TextBox x:Name="txtPayPalCancelUrl" Grid.Row="3" Grid.Column="1" Margin="0,3" Text="https://novvia.de/zahlung/abbruch"/>

                            <CheckBox x:Name="chkPayPalSandbox" Content="Sandbox-Modus (Test)" Grid.Row="4" Grid.Column="1" Margin="0,8"/>
                        </Grid>

                        <!-- Mollie -->
                        <TextBlock Text="Mollie" FontSize="18" FontWeight="SemiBold" Margin="0,25,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="API Key:" VerticalAlignment="Center"/>
                            <PasswordBox x:Name="txtMollieApiKey" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="Redirect URL:" VerticalAlignment="Center" Grid.Row="1"/>
                            <TextBox x:Name="txtMollieRedirectUrl" Grid.Row="1" Grid.Column="1" Margin="0,3" Text="https://novvia.de/zahlung/erfolg"/>

                            <TextBlock Text="Webhook URL:" VerticalAlignment="Center" Grid.Row="2"/>
                            <TextBox x:Name="txtMollieWebhookUrl" Grid.Row="2" Grid.Column="1" Margin="0,3" Text="https://novvia.de/api/mollie/webhook"/>
                        </Grid>

                        <!-- Bank / FinTS -->
                        <TextBlock Text="Bank / FinTS (HBCI)" FontSize="18" FontWeight="SemiBold" Margin="0,25,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Bankname:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtBankName" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="BLZ:" VerticalAlignment="Center" Grid.Row="1"/>
                            <TextBox x:Name="txtBankBLZ" Grid.Row="1" Grid.Column="1" Margin="0,3" MaxLength="8"/>

                            <TextBlock Text="Kontonummer:" VerticalAlignment="Center" Grid.Row="2"/>
                            <TextBox x:Name="txtBankKontonummer" Grid.Row="2" Grid.Column="1" Margin="0,3"/>

                            <TextBlock Text="IBAN:" VerticalAlignment="Center" Grid.Row="3"/>
                            <TextBox x:Name="txtBankIBAN" Grid.Row="3" Grid.Column="1" Margin="0,3" MaxLength="34"/>

                            <TextBlock Text="BIC:" VerticalAlignment="Center" Grid.Row="4"/>
                            <TextBox x:Name="txtBankBIC" Grid.Row="4" Grid.Column="1" Margin="0,3" MaxLength="11"/>

                            <TextBlock Text="FinTS-URL:" VerticalAlignment="Center" Grid.Row="5"/>
                            <TextBox x:Name="txtBankFinTSUrl" Grid.Row="5" Grid.Column="1" Margin="0,3"
                                     Text="https://banking-sn3.s-fints-pt-sn.de/fints30"/>
                        </Grid>

                        <!-- Allgemein -->
                        <TextBlock Text="Allgemein" FontSize="18" FontWeight="SemiBold" Margin="0,25,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="350"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Firmenname:" VerticalAlignment="Center"/>
                            <TextBox x:Name="txtPaymentFirmaName" Grid.Column="1" Margin="0,3"/>
                        </Grid>

                        <StackPanel Orientation="Horizontal" Margin="0,25,0,0">
                            <Button Content="Zahlungsanbieter speichern" Width="200" Click="ZahlungsanbieterSpeichern_Click"
                                    Background="{DynamicResource PrimaryBrush}" Foreground="White" Padding="10,8"/>
                            <Button Content="Verbindung testen" Width="150" Click="ZahlungsanbieterTesten_Click" Margin="15,0,0,0" Padding="10,8"/>
                        </StackPanel>

                        <TextBlock x:Name="txtPaymentStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>

                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- WooCommerce Shops Tab -->
            <TabItem Header="WooCommerce Shops">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="+ Neuer Shop" Click="WooShopNeu_Click" Padding="10,5" Margin="0,0,10,0"/>
                        <Button Content="Verbindung testen" Click="WooShopTest_Click" Padding="10,5" Margin="0,0,10,0"/>
                        <Button Content="Webhooks einrichten" Click="WooShopWebhooks_Click" Padding="10,5" Margin="0,0,10,0"/>
                        <CheckBox x:Name="chkWooTestModus" Content="Testmodus (alles loggen)" VerticalAlignment="Center" Margin="20,0,0,0"/>
                    </StackPanel>

                    <DataGrid x:Name="dgWooShops" Grid.Row="1" AutoGenerateColumns="False"
                              SelectionMode="Single" CanUserAddRows="False" SelectionChanged="DgWooShops_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Shop-URL" Binding="{Binding Url}" Width="250"/>
                            <DataGridTextColumn Header="Consumer Key" Binding="{Binding ConsumerKey}" Width="200"/>
                            <DataGridCheckBoxColumn Header="Aktiv" Binding="{Binding Aktiv}" Width="60"/>
                            <DataGridCheckBoxColumn Header="Webhooks" Binding="{Binding WebhooksAktiv}" Width="80"/>
                            <DataGridTextColumn Header="Sync-Intervall (Min)" Binding="{Binding SyncIntervallMinuten}" Width="120"/>
                            <DataGridTextColumn Header="Letzter Sync" Binding="{Binding LetzterSync, StringFormat=dd.MM.yyyy HH:mm}" Width="140" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <GroupBox Header="Shop-Details" Padding="10" Width="400">
                            <StackPanel>
                                <TextBlock Text="Consumer Secret:" Margin="0,0,0,5"/>
                                <PasswordBox x:Name="txtWooSecret" Width="350" HorizontalAlignment="Left"/>
                                <TextBlock Text="Webhook Secret:" Margin="0,10,0,5"/>
                                <TextBox x:Name="txtWooWebhookSecret" Width="350" IsReadOnly="True"/>
                                <TextBlock Text="Webhook Callback URL:" Margin="0,10,0,5"/>
                                <TextBox x:Name="txtWooCallbackUrl" Width="350" ToolTip="https://ihre-domain.de"/>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Aktionen" Padding="10" Margin="15,0,0,0" Width="250">
                            <StackPanel>
                                <Button Content="Shop speichern" Click="WooShopSpeichern_Click" Margin="0,0,0,10" Padding="10,5"/>
                                <Button Content="Shop loeschen" Click="WooShopLoeschen_Click" Margin="0,0,0,10" Padding="10,5" Background="#dc3545" Foreground="White"/>
                                <Separator Margin="0,10"/>
                                <TextBlock Text="Sync starten:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <Button Content="Kategorien sync" Click="WooSyncKategorien_Click" Margin="0,0,0,5" Padding="10,5"/>
                                <Button Content="Artikel sync" Click="WooSyncArtikel_Click" Margin="0,0,0,5" Padding="10,5"/>
                                <Button Content="Bestellungen import" Click="WooImportBestellungen_Click" Padding="10,5"/>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="API-Log (Testmodus)" Padding="10" Margin="15,0,0,0" Width="350">
                            <ScrollViewer MaxHeight="200">
                                <TextBox x:Name="txtWooApiLog" IsReadOnly="True" TextWrapping="Wrap"
                                         FontFamily="Consolas" FontSize="11" AcceptsReturn="True"/>
                            </ScrollViewer>
                        </GroupBox>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Steuern Tab -->
            <TabItem Header="Steuern">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Steuersaetze (nur Ansicht - Aenderungen in JTL-Wawi)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                    <DataGrid x:Name="dgSteuern" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KSteuer}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Steuersatz %" Binding="{Binding FSteuersatz, StringFormat=N2}" Width="100"/>
                            <DataGridTextColumn Header="Land" Binding="{Binding CISO}" Width="60"/>
                            <DataGridTextColumn Header="Standard" Binding="{Binding NStandard}" Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Konten Tab -->
            <TabItem Header="Konten">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Sachkonten (nur Ansicht - Aenderungen in JTL-Wawi)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                    <DataGrid x:Name="dgKonten" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Kontonr" Binding="{Binding CKontoNr}" Width="100"/>
                            <DataGridTextColumn Header="Bezeichnung" Binding="{Binding CName}" Width="250"/>
                            <DataGridTextColumn Header="Typ" Binding="{Binding CTyp}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Eigene Felder Tab -->
            <TabItem Header="Eigene Felder">
                <TabControl Margin="10">
                    <!-- Lieferant Eigene Felder (NOVVIA) -->
                    <TabItem Header="Lieferant">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="Neu" Width="80" Click="LieferantAttributNeu_Click" Margin="0,0,5,0"/>
                                <Button Content="Bearbeiten" Width="80" Click="LieferantAttributBearbeiten_Click" Margin="0,0,5,0"/>
                                <Button Content="Loeschen" Width="80" Click="LieferantAttributLoeschen_Click"/>
                                <TextBlock x:Name="txtLieferantHinweis" Text="" VerticalAlignment="Center" Foreground="Orange" Margin="15,0,0,0"/>
                            </StackPanel>

                            <DataGrid x:Name="dgLieferantAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="50"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                    <DataGridTextColumn Header="Sort" Binding="{Binding NSortierung}" Width="60"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <!-- Bearbeitungsbereich -->
                            <Border Grid.Row="2" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="180"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="90"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Name:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtLiefAttrName" Grid.Column="1"/>

                                    <TextBlock Text="Beschreibung:" VerticalAlignment="Center" Grid.Column="3"/>
                                    <TextBox x:Name="txtLiefAttrBeschr" Grid.Column="4"/>

                                    <TextBlock Text="Typ:" VerticalAlignment="Center" Grid.Column="6"/>
                                    <ComboBox x:Name="cmbLiefAttrTyp" Grid.Column="7" SelectedIndex="0">
                                        <ComboBoxItem Content="Text" Tag="3"/>
                                        <ComboBoxItem Content="Ganzzahl" Tag="1"/>
                                        <ComboBoxItem Content="Dezimal" Tag="2"/>
                                        <ComboBoxItem Content="Datum" Tag="4"/>
                                    </ComboBox>

                                    <TextBlock Text="Sort:" VerticalAlignment="Center" Grid.Column="9"/>
                                    <TextBox x:Name="txtLiefAttrSort" Grid.Column="10" Text="0"/>

                                    <Button Content="Speichern" Grid.Column="11" Width="100" HorizontalAlignment="Left" Margin="20,0,0,0" Click="LieferantAttributSpeichern_Click"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </TabItem>

                    <!-- Kunde Attribute (JTL - nur Ansicht) -->
                    <TabItem Header="Kunde">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Kunden-Attribute (JTL-Wawi - nur Ansicht, Aenderungen ueber Kunde.spKundenEigenesFeldCreateOrUpdate)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                            <DataGrid x:Name="dgKundeAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="60"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>

                    <!-- Artikel Attribute (JTL - nur Ansicht) -->
                    <TabItem Header="Artikel">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Artikel-Attribute / Freifelder (JTL-Wawi - nur Ansicht)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                            <DataGrid x:Name="dgArtikelAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="60"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>

                    <!-- Auftrag Attribute (JTL - nur Ansicht) -->
                    <TabItem Header="Auftrag">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Auftrags-Attribute / Freifelder (JTL-Wawi - nur Ansicht)" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>

                            <DataGrid x:Name="dgAuftragAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="60"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="250"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>

                    <!-- Firma Eigene Felder (JTL) -->
                    <TabItem Header="Firma">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Firma Attribute (Definitionen aus JTL-Wawi)" FontWeight="SemiBold" Margin="0,0,0,5"/>

                            <DataGrid x:Name="dgFirmaAttribute" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False" MaxHeight="200">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding KAttribut}" Width="50"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="200"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding FeldTypName}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <TextBlock Grid.Row="2" Text="Firma Eigene Felder (Werte)" FontWeight="SemiBold" Margin="0,10,0,5"/>

                            <DataGrid x:Name="dgFirmaEigeneFelder" Grid.Row="3" AutoGenerateColumns="False" IsReadOnly="True"
                                      SelectionMode="Single" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Attribut" Binding="{Binding CAttributName}" Width="250"/>
                                    <DataGridTextColumn Header="Wert" Binding="{Binding WertAnzeige}" Width="200"/>
                                    <DataGridTextColumn Header="Typ" Binding="{Binding NFeldTyp}" Width="60"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>

            <!-- Protokoll Tab -->
            <TabItem Header="Protokoll">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Statistik-Karten -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <Border Background="#e3f2fd" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Gesamt (7 Tage)" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogGesamt" Text="0" FontSize="20" FontWeight="Bold" Foreground="#1976d2"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#e8f5e9" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Shop" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogShop" Text="0" FontSize="20" FontWeight="Bold" Foreground="#388e3c"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#fff3e0" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Zahlungsabgleich" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogZahlung" Text="0" FontSize="20" FontWeight="Bold" Foreground="#f57c00"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#e1f5fe" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Stammdaten" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogStamm" Text="0" FontSize="20" FontWeight="Bold" Foreground="#0288d1"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#f3e5f5" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="Bewegungsdaten" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogBewegung" Text="0" FontSize="20" FontWeight="Bold" Foreground="#7b1fa2"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#ffebee" CornerRadius="5" Padding="15,10">
                            <StackPanel>
                                <TextBlock Text="Fehler" FontSize="11" Foreground="Gray"/>
                                <TextBlock x:Name="txtLogFehler" Text="0" FontSize="20" FontWeight="Bold" Foreground="#c62828"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Filter -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Kategorie:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="cmbLogKategorie" Width="150" Margin="0,0,15,0" SelectionChanged="LogFilter_Changed">
                            <ComboBoxItem Content="(Alle)" IsSelected="True"/>
                            <ComboBoxItem Content="Shop"/>
                            <ComboBoxItem Content="Zahlungsabgleich"/>
                            <ComboBoxItem Content="Stammdaten"/>
                            <ComboBoxItem Content="Bewegungsdaten"/>
                            <ComboBoxItem Content="Fehler"/>
                        </ComboBox>

                        <TextBlock Text="Modul:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="cmbLogModul" Width="150" Margin="0,0,15,0" SelectionChanged="LogFilter_Changed">
                            <ComboBoxItem Content="(Alle)" IsSelected="True"/>
                        </ComboBox>

                        <TextBlock Text="Zeitraum:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="cmbLogZeitraum" Width="150" Margin="0,0,15,0" SelectionChanged="LogFilter_Changed">
                            <ComboBoxItem Content="Heute" Tag="0"/>
                            <ComboBoxItem Content="Gestern" Tag="1"/>
                            <ComboBoxItem Content="Letzte 7 Tage" Tag="7" IsSelected="True"/>
                            <ComboBoxItem Content="Letzte 30 Tage" Tag="30"/>
                            <ComboBoxItem Content="Dieser Monat" Tag="M"/>
                            <ComboBoxItem Content="Letzter Monat" Tag="LM"/>
                            <ComboBoxItem Content="Dieses Jahr" Tag="Y"/>
                            <ComboBoxItem Content="Alle" Tag="ALL"/>
                        </ComboBox>

                        <TextBlock Text="Suche:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox x:Name="txtLogSuche" Width="200" Margin="0,0,15,0"/>

                        <Button Content="Suchen" Click="LogSuchen_Click" Padding="15,5" Margin="0,0,10,0"/>
                        <Button Content="Aktualisieren" Click="LogAktualisieren_Click" Padding="15,5"/>

                        <!-- Separator -->
                        <Border Width="1" Background="#ccc" Margin="15,0"/>

                        <!-- Log Aufbewahrung -->
                        <TextBlock Text="Aufbewahrung:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox x:Name="txtLogAufbewahrungTage" Width="50" Margin="0,0,5,0" Text="30"/>
                        <TextBlock Text="Tage" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <Button Content="Speichern" Click="LogAufbewahrungSpeichern_Click" Padding="10,5" Margin="0,0,10,0"/>
                        <Button Content="Alte Logs bereinigen" Click="LogBereinigen_Click" Padding="10,5"/>
                    </StackPanel>

                    <!-- Log-Tabelle -->
                    <DataGrid x:Name="dgLogs" Grid.Row="2" AutoGenerateColumns="False" IsReadOnly="True"
                              SelectionMode="Single" CanUserAddRows="False" RowHeight="28"
                              SelectionChanged="DgLogs_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Zeitpunkt" Binding="{Binding ZeitpunktAnzeige}" Width="140"/>
                            <DataGridTextColumn Header="Kategorie" Binding="{Binding CKategorie}" Width="110"/>
                            <DataGridTextColumn Header="Modul" Binding="{Binding CModul}" Width="120"/>
                            <DataGridTextColumn Header="Aktion" Binding="{Binding CAktion}" Width="130"/>
                            <DataGridTextColumn Header="Entity" Binding="{Binding CEntityNr}" Width="100"/>
                            <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="*"/>
                            <DataGridTextColumn Header="Benutzer" Binding="{Binding CBenutzerName}" Width="100"/>
                        </DataGrid.Columns>
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding NSeverity}" Value="3">
                                        <Setter Property="Background" Value="#ffebee"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding NSeverity}" Value="2">
                                        <Setter Property="Background" Value="#fff3e0"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>

                    <!-- Detail-Bereich -->
                    <Border Grid.Row="3" BorderBrush="#ddd" BorderThickness="0,1,0,0" Margin="0,10,0,0" Padding="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Feld:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogFeld" Text="-" Margin="0,0,20,0"/>
                                <TextBlock Text="Alter Wert:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogAlterWert" Text="-" Margin="0,0,20,0" Foreground="#c62828"/>
                                <TextBlock Text="Neuer Wert:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogNeuerWert" Text="-" Foreground="#388e3c"/>
                            </StackPanel>

                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,5,0,0">
                                <TextBlock Text="Details:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogDetails" Text="-" TextWrapping="Wrap" MaxWidth="800"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Top">
                                <TextBlock Text="Rechner:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogRechner" Text="-" Margin="0,0,15,0"/>
                                <TextBlock Text="IP:" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtLogIP" Text="-"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- NOVVIA Tab -->
            <TabItem Header="NOVVIA">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">

                        <!-- Pharma Einstellungen -->
                        <GroupBox Header="Pharma Einstellungen" Margin="0,0,0,20">
                            <Grid Margin="15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="250"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Pharma-Modus:" VerticalAlignment="Center"/>
                                <CheckBox x:Name="chkPharmaModus" Grid.Column="1" Content="Aktiviert (erweiterte Chargen-Validierung)" VerticalAlignment="Center"/>

                                <TextBlock Text="Quarantäne-Lager:" VerticalAlignment="Center" Grid.Row="1" Margin="0,10,0,0"/>
                                <ComboBox x:Name="cmbQuarantaeneLager" Grid.Row="1" Grid.Column="1" Margin="0,10,0,0"
                                          DisplayMemberPath="CName" SelectedValuePath="KWarenLager"/>
                            </Grid>
                        </GroupBox>

                        <!-- Zahlungsabgleich Einstellungen -->
                        <GroupBox Header="Zahlungsabgleich" Margin="0,0,0,20">
                            <Grid Margin="15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Auto-Match Schwelle:" VerticalAlignment="Center"/>
                                <TextBox x:Name="txtAutoMatchSchwelle" Grid.Column="1" Text="90"/>
                                <TextBlock Text="% (0-100)" Grid.Column="2" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="Gray"/>
                            </Grid>
                        </GroupBox>

                        <!-- Allgemein -->
                        <GroupBox Header="Allgemein" Margin="0,0,0,20">
                            <Grid Margin="15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="300"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Firmenname (Berichte):" VerticalAlignment="Center"/>
                                <TextBox x:Name="txtNovviaFirmenname" Grid.Column="1"/>

                                <TextBlock Text="Firmenlogo (PNG/JPG):" VerticalAlignment="Center" Grid.Row="1" Margin="0,10,0,0"/>
                                <TextBox x:Name="txtLogoPfad" Grid.Row="1" Grid.Column="1" Margin="0,10,0,0" IsReadOnly="True"/>
                                <Button Content="Durchsuchen..." Grid.Row="1" Grid.Column="2" Padding="10,4" Margin="8,10,0,0" Click="LogoAuswaehlen_Click"/>

                                <!-- Logo-Vorschau -->
                                <StackPanel Grid.Row="2" Grid.Column="1" Margin="0,10,0,0" Orientation="Horizontal">
                                    <Image x:Name="imgLogoPreview" MaxHeight="60" MaxWidth="200" HorizontalAlignment="Left"/>
                                    <Button x:Name="btnLogoEntfernen" Content="Entfernen" Padding="8,4" Margin="10,0,0,0"
                                            Click="LogoEntfernen_Click" Visibility="Collapsed"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <!-- Speichern Button -->
                        <StackPanel Orientation="Horizontal">
                            <Button Content="NOVVIA Einstellungen speichern" Padding="20,10" Click="NovviaEinstellungenSpeichern_Click"
                                    Background="{DynamicResource PrimaryBrush}" Foreground="White" FontWeight="SemiBold"/>
                        </StackPanel>

                        <TextBlock x:Name="txtNovviaStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>

                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Design Tab -->
            <TabItem Header="Design">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="Erscheinungsbild anpassen" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,5"/>
                        <TextBlock Text="Passen Sie Farben und Stil der Anwendung an." Foreground="Gray" Margin="0,0,0,20"/>

                        <base:ThemeSettingsControl x:Name="themeSettings"/>

                        <!-- Grid-Formatierung -->
                        <GroupBox Header="Grid-Formatierung" Margin="0,25,0,0">
                            <StackPanel Margin="15">
                                <!-- Allgemeine Einstellungen -->
                                <TextBlock Text="Allgemein" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="130"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="30"/>
                                        <ColumnDefinition Width="130"/>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Text="Zeilenhoehe:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtGridZeilenhoehe" Grid.Column="1" Text="18"/>

                                    <TextBlock Text="Schriftart:" VerticalAlignment="Center" Grid.Column="3"/>
                                    <ComboBox x:Name="cmbGridSchriftart" Grid.Column="4">
                                        <ComboBoxItem Content="Segoe UI" IsSelected="True"/>
                                        <ComboBoxItem Content="Arial"/>
                                        <ComboBoxItem Content="Calibri"/>
                                        <ComboBoxItem Content="Consolas"/>
                                        <ComboBoxItem Content="Tahoma"/>
                                    </ComboBox>

                                    <TextBlock Text="Schriftgroesse:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                    <TextBox x:Name="txtGridSchriftgroesse" Grid.Row="1" Grid.Column="1" Text="12" Margin="0,8,0,0"/>

                                    <TextBlock Text="Gitternetzlinien:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="3" Margin="0,8,0,0"/>
                                    <ComboBox x:Name="cmbGridLinien" Grid.Row="1" Grid.Column="4" Margin="0,8,0,0">
                                        <ComboBoxItem Content="Alle" Tag="All" IsSelected="True"/>
                                        <ComboBoxItem Content="Horizontal" Tag="Horizontal"/>
                                        <ComboBoxItem Content="Vertikal" Tag="Vertical"/>
                                        <ComboBoxItem Content="Keine" Tag="None"/>
                                    </ComboBox>
                                </Grid>

                                <!-- Header-Zeile -->
                                <TextBlock Text="Header-Zeile" FontWeight="SemiBold" FontSize="14" Margin="0,20,0,10"/>
                                <Border BorderBrush="#ddd" BorderThickness="1" Padding="10" CornerRadius="3">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Hintergrund:" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtGridHeaderBg" Grid.Column="1" Text="#f0f0f0"/>

                                        <TextBlock Text="Textfarbe:" VerticalAlignment="Center" Grid.Column="3"/>
                                        <TextBox x:Name="txtGridHeaderFg" Grid.Column="4" Text="#333333"/>

                                        <TextBlock Text="Schriftstaerke:" VerticalAlignment="Center" Grid.Column="6"/>
                                        <ComboBox x:Name="cmbGridHeaderFontWeight" Grid.Column="7">
                                            <ComboBoxItem Content="Normal"/>
                                            <ComboBoxItem Content="SemiBold" IsSelected="True"/>
                                            <ComboBoxItem Content="Bold"/>
                                        </ComboBox>

                                        <TextBlock Text="Rahmenfarbe:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtGridHeaderBorderColor" Grid.Row="1" Grid.Column="1" Text="#cccccc" Margin="0,8,0,0"/>

                                        <TextBlock Text="Rahmenstaerke:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="3" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtGridHeaderBorderWidth" Grid.Row="1" Grid.Column="4" Text="1" Margin="0,8,0,0"/>

                                        <TextBlock Text="Hoehe:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="6" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtGridHeaderHoehe" Grid.Row="1" Grid.Column="7" Text="32" Margin="0,8,0,0"/>
                                    </Grid>
                                </Border>

                                <!-- Zeile 1 (Gerade Zeilen) -->
                                <TextBlock Text="Zeile 1 (Gerade Zeilen)" FontWeight="SemiBold" FontSize="14" Margin="0,15,0,10"/>
                                <Border BorderBrush="#ddd" BorderThickness="1" Padding="10" CornerRadius="3">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Hintergrund:" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtGridRowBg" Grid.Column="1" Text="#ffffff"/>

                                        <TextBlock Text="Textfarbe:" VerticalAlignment="Center" Grid.Column="3"/>
                                        <TextBox x:Name="txtGridRowFg" Grid.Column="4" Text="#333333"/>

                                        <TextBlock Text="Schriftstaerke:" VerticalAlignment="Center" Grid.Column="6"/>
                                        <ComboBox x:Name="cmbGridRowFontWeight" Grid.Column="7">
                                            <ComboBoxItem Content="Normal" IsSelected="True"/>
                                            <ComboBoxItem Content="SemiBold"/>
                                            <ComboBoxItem Content="Bold"/>
                                        </ComboBox>

                                        <TextBlock Text="Rahmenfarbe:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtGridRowBorderColor" Grid.Row="1" Grid.Column="1" Text="#e0e0e0" Margin="0,8,0,0"/>

                                        <TextBlock Text="Rahmenstaerke:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="3" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtGridRowBorderWidth" Grid.Row="1" Grid.Column="4" Text="1" Margin="0,8,0,0"/>
                                    </Grid>
                                </Border>

                                <!-- Zeile 2 (Ungerade/Alternierende Zeilen) -->
                                <TextBlock Text="Zeile 2 (Ungerade Zeilen / Zebrastreifen)" FontWeight="SemiBold" FontSize="14" Margin="0,15,0,10"/>
                                <Border BorderBrush="#ddd" BorderThickness="1" Padding="10" CornerRadius="3">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Hintergrund:" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtGridRowAltBg" Grid.Column="1" Text="#f9f9f9"/>

                                        <TextBlock Text="Textfarbe:" VerticalAlignment="Center" Grid.Column="3"/>
                                        <TextBox x:Name="txtGridRowAltFg" Grid.Column="4" Text="#333333"/>

                                        <TextBlock Text="Schriftstaerke:" VerticalAlignment="Center" Grid.Column="6"/>
                                        <ComboBox x:Name="cmbGridRowAltFontWeight" Grid.Column="7">
                                            <ComboBoxItem Content="Normal" IsSelected="True"/>
                                            <ComboBoxItem Content="SemiBold"/>
                                            <ComboBoxItem Content="Bold"/>
                                        </ComboBox>

                                        <CheckBox x:Name="chkGridZebraStreifen" Content="Zebrastreifen aktivieren" IsChecked="True" Grid.Row="1" Margin="0,8,0,0"/>
                                    </Grid>
                                </Border>

                                <!-- Selektion -->
                                <TextBlock Text="Selektion (ausgewaehlte Zeile)" FontWeight="SemiBold" FontSize="14" Margin="0,15,0,10"/>
                                <Border BorderBrush="#ddd" BorderThickness="1" Padding="10" CornerRadius="3">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Text="Hintergrund:" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtGridSelectionBg" Grid.Column="1" Text="#E86B5C"/>

                                        <TextBlock Text="Textfarbe:" VerticalAlignment="Center" Grid.Column="3"/>
                                        <TextBox x:Name="txtGridSelectionFg" Grid.Column="4" Text="#ffffff"/>
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </GroupBox>

                        <!-- Datums- und Zahlenformatierung -->
                        <GroupBox Header="Datums- und Zahlenformatierung" Margin="0,20,0,0">
                            <StackPanel Margin="15">
                                <!-- Datumsformate -->
                                <TextBlock Text="Datumsformate" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10"/>
                                <Border BorderBrush="#ddd" BorderThickness="1" Padding="10" CornerRadius="3">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Datum:" VerticalAlignment="Center"/>
                                        <ComboBox x:Name="cmbDatumFormat" Grid.Column="1">
                                            <ComboBoxItem Content="dd.MM.yyyy" IsSelected="True"/>
                                            <ComboBoxItem Content="dd/MM/yyyy"/>
                                            <ComboBoxItem Content="yyyy-MM-dd"/>
                                            <ComboBoxItem Content="dd. MMM yyyy"/>
                                            <ComboBoxItem Content="d. MMMM yyyy"/>
                                        </ComboBox>

                                        <TextBlock Text="Datum + Zeit:" VerticalAlignment="Center" Grid.Column="3"/>
                                        <ComboBox x:Name="cmbDatumZeitFormat" Grid.Column="4">
                                            <ComboBoxItem Content="dd.MM.yyyy HH:mm" IsSelected="True"/>
                                            <ComboBoxItem Content="dd.MM.yyyy HH:mm:ss"/>
                                            <ComboBoxItem Content="dd/MM/yyyy HH:mm"/>
                                            <ComboBoxItem Content="yyyy-MM-dd HH:mm"/>
                                        </ComboBox>

                                        <TextBlock Text="Zeit:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                        <ComboBox x:Name="cmbZeitFormat" Grid.Row="1" Grid.Column="1" Margin="0,8,0,0">
                                            <ComboBoxItem Content="HH:mm" IsSelected="True"/>
                                            <ComboBoxItem Content="HH:mm:ss"/>
                                            <ComboBoxItem Content="hh:mm tt"/>
                                        </ComboBox>
                                    </Grid>
                                </Border>

                                <!-- Zahlenformate -->
                                <TextBlock Text="Zahlenformate" FontWeight="SemiBold" FontSize="14" Margin="0,15,0,10"/>
                                <Border BorderBrush="#ddd" BorderThickness="1" Padding="10" CornerRadius="3">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Tausendertrenner:" VerticalAlignment="Center"/>
                                        <ComboBox x:Name="cmbTausenderTrenner" Grid.Column="1">
                                            <ComboBoxItem Content="." IsSelected="True"/>
                                            <ComboBoxItem Content=","/>
                                            <ComboBoxItem Content=" "/>
                                            <ComboBoxItem Content="(kein)"/>
                                        </ComboBox>

                                        <TextBlock Text="Dezimaltrenner:" VerticalAlignment="Center" Grid.Column="3"/>
                                        <ComboBox x:Name="cmbDezimalTrenner" Grid.Column="4">
                                            <ComboBoxItem Content="," IsSelected="True"/>
                                            <ComboBoxItem Content="."/>
                                        </ComboBox>

                                        <TextBlock Text="Dezimalstellen:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtDezimalstellen" Grid.Row="1" Grid.Column="1" Text="2" Margin="0,8,0,0"/>

                                        <TextBlock Text="Waehrungssymbol:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="3" Margin="0,8,0,0"/>
                                        <ComboBox x:Name="cmbWaehrungSymbol" Grid.Row="1" Grid.Column="4" Margin="0,8,0,0">
                                            <ComboBoxItem Content="EUR" IsSelected="True"/>
                                            <ComboBoxItem Content="€"/>
                                            <ComboBoxItem Content="CHF"/>
                                            <ComboBoxItem Content="USD"/>
                                            <ComboBoxItem Content="$"/>
                                        </ComboBox>

                                        <CheckBox x:Name="chkWaehrungAnzeigen" Content="Waehrungssymbol anzeigen" IsChecked="True" Grid.Row="2" Margin="0,8,0,0"/>

                                        <!-- Vorschau -->
                                        <Border Grid.Row="3" Grid.ColumnSpan="6" Background="#f5f5f5" Padding="10" Margin="0,10,0,0" CornerRadius="3">
                                            <StackPanel>
                                                <TextBlock Text="Vorschau:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="Datum: " Foreground="Gray"/>
                                                    <TextBlock x:Name="txtFormatVorschauDatum" Text="02.01.2026" Margin="0,0,20,0"/>
                                                    <TextBlock Text="Betrag: " Foreground="Gray"/>
                                                    <TextBlock x:Name="txtFormatVorschauBetrag" Text="1.234,56 EUR" Margin="0,0,20,0"/>
                                                    <TextBlock Text="Menge: " Foreground="Gray"/>
                                                    <TextBlock x:Name="txtFormatVorschauMenge" Text="42"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </GroupBox>

                        <!-- Vorschau -->
                        <GroupBox Header="Vorschau" Margin="0,20,0,0">
                            <DataGrid x:Name="dgGridVorschau" Height="150" Margin="10" AutoGenerateColumns="False"
                                      IsReadOnly="True" CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Artikelnr." Width="100"/>
                                    <DataGridTextColumn Header="Bezeichnung" Width="200"/>
                                    <DataGridTextColumn Header="Lagerbestand" Width="100"/>
                                    <DataGridTextColumn Header="VK Netto" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>

                        <!-- Speichern-Buttons -->
                        <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                            <Button Content="Grid-Einstellungen speichern" Click="GridEinstellungenSpeichern_Click" Padding="20,10"
                                    Background="{DynamicResource PrimaryBrush}" Foreground="White" FontWeight="SemiBold"/>
                            <Button Content="Vorschau aktualisieren" Click="GridVorschauAktualisieren_Click" Padding="15,10" Margin="15,0,0,0"/>
                            <Button Content="Auf Standard zuruecksetzen" Click="GridEinstellungenReset_Click" Padding="15,10" Margin="15,0,0,0"/>
                        </StackPanel>

                        <TextBlock x:Name="txtGridStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Nummernkreise Tab -->
            <TabItem Header="Nummernkreise">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="Nummernkreise verwalten" FontSize="18" FontWeight="SemiBold"/>
                        <TextBlock Text="(JTL tLaufendeNummern)" Foreground="Gray" FontSize="12" VerticalAlignment="Bottom" Margin="10,0,0,2"/>
                    </StackPanel>

                    <DataGrid x:Name="dgNummernkreise" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False" CanUserDeleteRows="False"
                              SelectionMode="Single" SelectionUnit="FullRow"
                              BorderThickness="1" BorderBrush="#ddd"
                              CellEditEnding="DgNummernkreise_CellEditEnding">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KLaufendeNummer}" Width="50" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Anzeigename" Binding="{Binding CAnzeigename}" Width="180" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Interne Bezeichnung" Binding="{Binding CName}" Width="180" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Praefix" Binding="{Binding CPrefix}" Width="120"/>
                            <DataGridTextColumn Header="Aktuelle Nr." Binding="{Binding NNummer}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Suffix" Binding="{Binding CSuffix}" Width="100"/>
                            <DataGridTextColumn Header="Tabelle" Binding="{Binding CTable}" Width="150" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Spalte" Binding="{Binding CColumn}" Width="120" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                        <Button Content="Aktualisieren" Padding="15,8" Margin="0,0,10,0" Click="BtnNummernkreiseAktualisieren_Click"/>
                        <Button Content="Aenderungen speichern" Padding="15,8" Background="#28a745" Foreground="White" BorderThickness="0" Click="BtnNummernkreiseSpeichern_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Vorgangsfarben Tab (JTL dbo.tFarbe) -->
            <TabItem Header="Vorgangsfarben">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="Auftragsfarben definieren" FontSize="18" FontWeight="SemiBold"/>
                        <TextBlock Text="(JTL tFarbe - Farben fuer Auftraege und Rechnungen)" Foreground="Gray" FontSize="12" VerticalAlignment="Bottom" Margin="10,0,0,2"/>
                    </StackPanel>

                    <DataGrid x:Name="dgVorgangsfarben" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False" CanUserDeleteRows="False"
                              SelectionMode="Single" SelectionUnit="FullRow"
                              BorderThickness="1" BorderBrush="#ddd"
                              SelectionChanged="DgVorgangsfarben_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding KFarbe}" Width="50" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Bezeichnung" Binding="{Binding CName}" Width="250"/>
                            <DataGridTextColumn Header="Farbe (Hex)" Binding="{Binding FarbeHex}" Width="100" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Farbcode" Binding="{Binding NFarbcode}" Width="100"/>
                            <DataGridTextColumn Header="Rot" Binding="{Binding NRotwert}" Width="60"/>
                            <DataGridTextColumn Header="Gruen" Binding="{Binding NGruenwert}" Width="60"/>
                            <DataGridTextColumn Header="Blau" Binding="{Binding NBlauwert}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,15,0,0">
                        <Button Content="Neue Farbe" Padding="15,8" Margin="0,0,10,0" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Click="BtnVorgangsfarbeNeu_Click"/>
                        <Button x:Name="btnVorgangsfarbeLoeschen" Content="Loeschen" Padding="15,8" Margin="0,0,10,0"
                                Foreground="#D32F2F" Click="BtnVorgangsfarbeLoeschen_Click" IsEnabled="False"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="20,0,0,0">
                            <Button Content="Aktualisieren" Padding="15,8" Margin="0,0,10,0" Click="BtnVorgangsfarbenAktualisieren_Click"/>
                            <Button Content="Aenderungen speichern" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Click="BtnVorgangsfarbenSpeichern_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Briefpapier Tab -->
            <TabItem Header="Briefpapier">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Briefpapier / Hintergrund fuer Belege" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <TextBlock Grid.Row="1" Text="Waehlen Sie ein Hintergrundbild aus den JTL-Vorlagen fuer jeden Belegtyp." Foreground="Gray" Margin="0,0,0,20"/>

                    <Grid Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="300"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Belegtyp-Zuordnung -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Text="Zuordnung pro Belegtyp" FontWeight="SemiBold" Margin="0,0,0,10"/>

                            <CheckBox x:Name="chkBriefpapierAktiv" Content="Briefpapier aktiviert" Margin="0,0,0,15"
                                      IsChecked="True" Checked="BriefpapierAktiv_Changed" Unchecked="BriefpapierAktiv_Changed"/>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Rechnung:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Column="1" x:Name="cmbBriefpapierRechnung" DisplayMemberPath="CName" SelectedValuePath="KVorlage"/>

                                <TextBlock Grid.Row="1" Text="Lieferschein:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="cmbBriefpapierLieferschein" DisplayMemberPath="CName" SelectedValuePath="KVorlage"/>

                                <TextBlock Grid.Row="2" Text="Mahnung:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="2" Grid.Column="1" x:Name="cmbBriefpapierMahnung" DisplayMemberPath="CName" SelectedValuePath="KVorlage"/>

                                <TextBlock Grid.Row="3" Text="Angebot:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="3" Grid.Column="1" x:Name="cmbBriefpapierAngebot" DisplayMemberPath="CName" SelectedValuePath="KVorlage"/>

                                <TextBlock Grid.Row="4" Text="Auftrag:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="4" Grid.Column="1" x:Name="cmbBriefpapierAuftrag" DisplayMemberPath="CName" SelectedValuePath="KVorlage"/>

                                <TextBlock Grid.Row="5" Text="Gutschrift:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="5" Grid.Column="1" x:Name="cmbBriefpapierGutschrift" DisplayMemberPath="CName" SelectedValuePath="KVorlage"/>
                            </Grid>
                        </StackPanel>

                        <!-- Verfuegbare Bilder -->
                        <GroupBox Grid.Column="1" Header="Verfuegbare Bilder (aus JTL Report.tVorlage)">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <DataGrid x:Name="dgBriefpapierBilder" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single"
                                          SelectionChanged="BriefpapierBilder_SelectionChanged">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="ID" Binding="{Binding KVorlage}" Width="60"/>
                                        <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="*"/>
                                        <DataGridTextColumn Header="Groesse" Binding="{Binding GroesseFormatiert}" Width="100"/>
                                        <DataGridTextColumn Header="Geaendert" Binding="{Binding GeaendertAm, StringFormat=dd.MM.yyyy}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                                    <Button Content="Alle Bilder anzeigen" Click="BtnAlleBilderAnzeigen_Click" Padding="10,5" Margin="0,0,10,0"/>
                                    <Button Content="Nur Briefpapier anzeigen" Click="BtnNurBriefpapierAnzeigen_Click" Padding="10,5" Margin="0,0,10,0"/>
                                    <Button Content="Vorschau" Click="BtnBriefpapierVorschau_Click" Padding="10,5" Margin="0,0,10,0"/>
                                    <Button Content="Neues Bild hochladen..." Click="BtnBriefpapierUpload_Click" Padding="10,5" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                    </Grid>

                    <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,15,0,0">
                        <Button Content="Aktualisieren" Padding="15,8" Margin="0,0,10,0" Click="BtnBriefpapierAktualisieren_Click"/>
                        <Button Content="Einstellungen speichern" Padding="15,8" Background="#28a745" Foreground="White" BorderThickness="0" Click="BtnBriefpapierSpeichern_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Mahnstufen Tab -->
            <TabItem Header="Mahnstufen">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Margin="0,0,0,15">
                        <TextBlock Text="Mahnstufen-Konfiguration" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,5"/>
                        <TextBlock Text="Konfigurieren Sie Karenzzeit, Zahlungsfrist und Gebuehren fuer jede Mahnstufe. Die Texte werden ueber den Formular-Designer gepflegt." Foreground="Gray"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" x:Name="dgMahnstufen" AutoGenerateColumns="False" CanUserAddRows="False"
                              CanUserDeleteRows="False" RowHeight="28">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Stufe" Binding="{Binding NStufe}" Width="60" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="180"/>
                            <DataGridTextColumn Header="Karenzzeit (Tage)" Binding="{Binding NKarenzzeit}" Width="120"/>
                            <DataGridTextColumn Header="Zahlungsfrist (Tage)" Binding="{Binding NZahlungsfristInTagen}" Width="130"/>
                            <DataGridTextColumn Header="Gebuehr pauschal (EUR)" Binding="{Binding FGebuehrPauschal, StringFormat=N2}" Width="140"/>
                            <DataGridTextColumn Header="Zinssatz (%)" Binding="{Binding FGebuehrZinssatz, StringFormat=N2}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,15,0,0">
                        <Button Content="Aktualisieren" Padding="15,8" Margin="0,0,10,0" Click="BtnMahnstufen_Aktualisieren"/>
                        <Button Content="Aenderungen speichern" Padding="15,8" Background="#28a745" Foreground="White" BorderThickness="0" Click="BtnMahnstufen_Speichern"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Vorlagen-Import Tab -->
            <TabItem Header="Vorlagen-Import">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="JTL List &amp; Label Vorlagen" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>
                        <TextBlock Text="Hier koennen Sie JTL-Vorlagen anzeigen und Bilder/Logos exportieren." Foreground="Gray" Margin="0,0,0,20"/>

                        <!-- Statistik -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                            <Border Background="#e3f2fd" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                                <StackPanel>
                                    <TextBlock Text="Vorlagen" FontSize="11" Foreground="Gray"/>
                                    <TextBlock x:Name="txtVorlagenAnzahl" Text="0" FontSize="20" FontWeight="Bold" Foreground="#1976d2"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#e8f5e9" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                                <StackPanel>
                                    <TextBlock Text="Bilder/Logos" FontSize="11" Foreground="Gray"/>
                                    <TextBlock x:Name="txtBilderAnzahl" Text="0" FontSize="20" FontWeight="Bold" Foreground="#388e3c"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#fff3e0" CornerRadius="5" Padding="15,10" Margin="0,0,10,0">
                                <StackPanel>
                                    <TextBlock Text="E-Mail Vorlagen" FontSize="11" Foreground="Gray"/>
                                    <TextBlock x:Name="txtEmailVorlagenAnzahl" Text="0" FontSize="20" FontWeight="Bold" Foreground="#f57c00"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- JTL Bilder -->
                        <GroupBox Header="JTL Bilder / Logos" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="200"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <DataGrid x:Name="dgJtlBilder" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="250"/>
                                        <DataGridTextColumn Header="Groesse" Binding="{Binding SizeText}" Width="100"/>
                                        <DataGridTextColumn Header="Geaendert" Binding="{Binding LastModified, StringFormat=dd.MM.yyyy}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                                    <Button Content="Ausgewaehltes Bild exportieren" Click="VorlagenBildExport_Click" Padding="15,8" Margin="0,0,10,0"/>
                                    <Button Content="Alle Bilder exportieren" Click="VorlagenAlleBilderExport_Click" Padding="15,8" Margin="0,0,10,0"/>
                                    <Button Content="Bild in NOVVIA importieren" Click="VorlagenBildImport_Click" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <!-- JTL Vorlagen (List &amp; Label) -->
                        <GroupBox Header="JTL Formular-Vorlagen (List &amp; Label - nur Anzeige)" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="200"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <ComboBox x:Name="cmbVorlagenTypFilter" Width="150" SelectionChanged="VorlagenTypFilter_Changed">
                                        <ComboBoxItem Content="Alle Typen" IsSelected="True" Tag=""/>
                                        <ComboBoxItem Content="Rechnungen" Tag="15"/>
                                        <ComboBoxItem Content="Etiketten" Tag="128"/>
                                        <ComboBoxItem Content="Angebote" Tag="1"/>
                                        <ComboBoxItem Content="Gutschriften" Tag="4"/>
                                        <ComboBoxItem Content="Standard" Tag="31"/>
                                        <ComboBoxItem Content="Bausteine" Tag="32"/>
                                    </ComboBox>
                                    <Button Content="Aktualisieren" Margin="15,0,0,0" Padding="10,5" Click="VorlagenAktualisieren_Click"/>
                                </StackPanel>
                                <DataGrid Grid.Row="1" x:Name="dgJtlVorlagen" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="200"/>
                                        <DataGridTextColumn Header="Typ" Binding="{Binding TypName}" Width="120"/>
                                        <DataGridTextColumn Header="Groesse" Binding="{Binding SizeText}" Width="80"/>
                                        <DataGridTextColumn Header="Geaendert" Binding="{Binding LastModified, StringFormat=dd.MM.yyyy HH:mm}" Width="130"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </GroupBox>

                        <!-- Hinweis -->
                        <Border Background="#fff3e0" Padding="15" CornerRadius="5">
                            <StackPanel>
                                <TextBlock Text="Hinweis zu List &amp; Label Vorlagen" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <TextBlock TextWrapping="Wrap" Foreground="#666">
                                    Die JTL-Formularvorlagen verwenden das proprietaere "List &amp; Label" Format von combit.
                                    Diese koennen nicht direkt in NOVVIA bearbeitet werden, da dafuer eine kostenpflichtige Lizenz erforderlich waere.
                                    Bilder und Logos koennen jedoch exportiert und in NOVVIA-Formulare importiert werden.
                                </TextBlock>
                            </StackPanel>
                        </Border>

                        <TextBlock x:Name="txtVorlagenStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Formular-Designer Tab -->
            <TabItem Header="Formular-Designer">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="NOVVIA Formular-Designer" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>
                        <TextBlock Text="Erstellen und bearbeiten Sie eigene Formulare fuer Rechnungen, Lieferscheine, Angebote etc."
                                   Foreground="Gray" TextWrapping="Wrap" Margin="0,0,0,20"/>

                        <Border Background="#e3f2fd" Padding="20" CornerRadius="8" Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="Formular-Designer oeffnen" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                <TextBlock Text="Der Formular-Designer ermoeglicht die visuelle Bearbeitung von Belegen mit Drag &amp; Drop."
                                           Foreground="#666" TextWrapping="Wrap" Margin="0,0,0,15"/>
                                <Button Content="Formular-Designer oeffnen" Padding="20,10"
                                        Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0"
                                        FontSize="14" HorizontalAlignment="Left"
                                        Click="BtnFormularDesigner_Click"/>
                            </StackPanel>
                        </Border>

                        <Border Background="#fff3e0" Padding="15" CornerRadius="5">
                            <StackPanel>
                                <TextBlock Text="Hinweis" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <TextBlock TextWrapping="Wrap" Foreground="#666">
                                    Der Formular-Designer befindet sich noch in Entwicklung.
                                    Grundlegende Funktionen wie Drag &amp; Drop von Elementen sind bereits verfuegbar.
                                </TextBlock>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Benutzer & Rollen Tab -->
            <TabItem Header="Benutzer &amp; Rollen">
                <TabControl Margin="10">
                    <!-- Benutzer Sub-Tab -->
                    <TabItem Header="Benutzer">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Linke Seite: Benutzer-Liste -->
                            <Border BorderBrush="#ddd" BorderThickness="0,0,1,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <StackPanel Orientation="Horizontal" Margin="10,10,10,5">
                                        <Button Content="Neu" Click="BenutzerNeu_Click" Padding="12,6" Margin="0,0,8,0"
                                                Background="{DynamicResource PrimaryBrush}" Foreground="White"/>
                                        <Button x:Name="btnBenutzerLoeschen" Content="Loeschen" Click="BenutzerLoeschen_Click"
                                                Padding="12,6" IsEnabled="False"/>
                                    </StackPanel>

                                    <ListBox x:Name="lstBenutzer" Grid.Row="1" Margin="10,5,10,10"
                                             SelectionChanged="LstBenutzer_SelectionChanged">
                                        <ListBox.Resources>
                                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="{DynamicResource PrimaryColor}"/>
                                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>
                                        </ListBox.Resources>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding CBenutzername}" FontWeight="SemiBold" Width="120"/>
                                                    <TextBlock Text="{Binding VollName}" Foreground="Gray"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                        <ListBox.ItemContainerStyle>
                                            <Style TargetType="ListBoxItem">
                                                <Setter Property="Padding" Value="10,6"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ListBox.ItemContainerStyle>
                                    </ListBox>
                                </Grid>
                            </Border>

                            <!-- Rechte Seite: Benutzer-Details -->
                            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
                                <StackPanel Margin="20,15">
                                    <TextBlock Text="Benutzer-Details" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="130"/>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Benutzername:" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtBenutzerName" Grid.Column="1"/>

                                        <TextBlock Text="Vorname:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtBenutzerVorname" Grid.Row="1" Grid.Column="1" Margin="0,8,0,0"/>

                                        <TextBlock Text="Nachname:" VerticalAlignment="Center" Grid.Row="2" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtBenutzerNachname" Grid.Row="2" Grid.Column="1" Margin="0,8,0,0"/>

                                        <TextBlock Text="E-Mail:" VerticalAlignment="Center" Grid.Row="3" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtBenutzerEmail" Grid.Row="3" Grid.Column="1" Margin="0,8,0,0"/>

                                        <TextBlock Text="Telefon:" VerticalAlignment="Center" Grid.Row="4" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtBenutzerTelefon" Grid.Row="4" Grid.Column="1" Margin="0,8,0,0"/>

                                        <TextBlock Text="Neues Passwort:" VerticalAlignment="Center" Grid.Row="5" Margin="0,8,0,0"/>
                                        <PasswordBox x:Name="txtBenutzerPasswort" Grid.Row="5" Grid.Column="1" Margin="0,8,0,0"/>
                                    </Grid>

                                    <!-- Status-Optionen -->
                                    <TextBlock Text="Status" FontSize="14" FontWeight="SemiBold" Margin="0,20,0,10"/>
                                    <StackPanel>
                                        <CheckBox x:Name="chkBenutzerAktiv" Content="Benutzer ist aktiv" IsChecked="True" Margin="0,0,0,5"/>
                                        <CheckBox x:Name="chkBenutzerGesperrt" Content="Benutzer ist gesperrt" Margin="0,0,0,5"/>
                                    </StackPanel>

                                    <!-- Rollen-Zuweisung -->
                                    <TextBlock Text="Rollen" FontSize="14" FontWeight="SemiBold" Margin="0,20,0,10"/>
                                    <ListBox x:Name="lstBenutzerRollen" Height="150" SelectionMode="Multiple">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <CheckBox Content="{Binding CBezeichnung}" IsChecked="{Binding IsSelected}"
                                                          Margin="5,2" Click="BenutzerRolle_Click"/>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>

                                    <!-- Speichern -->
                                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                                        <Button Content="Speichern" Click="BenutzerSpeichern_Click" Padding="20,8"
                                                Background="{DynamicResource PrimaryBrush}" Foreground="White" FontWeight="SemiBold"/>
                                        <Button Content="Passwort zuruecksetzen" Click="BenutzerPasswortReset_Click"
                                                Padding="15,8" Margin="15,0,0,0"/>
                                    </StackPanel>

                                    <TextBlock x:Name="txtBenutzerStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </TabItem>

                    <!-- Rollen Sub-Tab -->
                    <TabItem Header="Rollen">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Linke Seite: Rollen-Liste -->
                            <Border BorderBrush="#ddd" BorderThickness="0,0,1,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <StackPanel Orientation="Horizontal" Margin="10,10,10,5">
                                        <Button Content="Neu" Click="RolleNeu_Click" Padding="12,6" Margin="0,0,8,0"
                                                Background="{DynamicResource PrimaryBrush}" Foreground="White"/>
                                        <Button x:Name="btnRolleLoeschen" Content="Loeschen" Click="RolleLoeschen_Click"
                                                Padding="12,6" IsEnabled="False"/>
                                    </StackPanel>

                                    <ListBox x:Name="lstRollen" Grid.Row="1" Margin="10,5,10,10"
                                             DisplayMemberPath="CBezeichnung"
                                             SelectionChanged="LstRollen_SelectionChanged">
                                        <ListBox.Resources>
                                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="{DynamicResource PrimaryColor}"/>
                                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>
                                        </ListBox.Resources>
                                        <ListBox.ItemContainerStyle>
                                            <Style TargetType="ListBoxItem">
                                                <Setter Property="Padding" Value="10,6"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ListBox.ItemContainerStyle>
                                    </ListBox>
                                </Grid>
                            </Border>

                            <!-- Rechte Seite: Rollen-Details -->
                            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
                                <StackPanel Margin="20,15">
                                    <TextBlock Text="Rollen-Details" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="130"/>
                                            <ColumnDefinition Width="300"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Name (intern):" VerticalAlignment="Center"/>
                                        <TextBox x:Name="txtRolleName" Grid.Column="1"/>

                                        <TextBlock Text="Bezeichnung:" VerticalAlignment="Center" Grid.Row="1" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtRolleBezeichnung" Grid.Row="1" Grid.Column="1" Margin="0,8,0,0"/>

                                        <TextBlock Text="Beschreibung:" VerticalAlignment="Center" Grid.Row="2" Margin="0,8,0,0"/>
                                        <TextBox x:Name="txtRolleBeschreibung" Grid.Row="2" Grid.Column="1" Margin="0,8,0,0"
                                                 TextWrapping="Wrap" Height="60" AcceptsReturn="True"/>
                                    </Grid>

                                    <!-- Rollen-Optionen -->
                                    <TextBlock Text="Optionen" FontSize="14" FontWeight="SemiBold" Margin="0,20,0,10"/>
                                    <StackPanel>
                                        <CheckBox x:Name="chkRolleAktiv" Content="Rolle ist aktiv" IsChecked="True" Margin="0,0,0,5"/>
                                        <CheckBox x:Name="chkRolleAdmin" Content="Administrator-Rolle (alle Rechte)" Margin="0,0,0,5"/>
                                        <CheckBox x:Name="chkRolleSystem" Content="System-Rolle (nicht loeschbar)" IsEnabled="False" Margin="0,0,0,5"/>
                                    </StackPanel>

                                    <!-- Benutzer mit dieser Rolle -->
                                    <TextBlock Text="Benutzer mit dieser Rolle" FontSize="14" FontWeight="SemiBold" Margin="0,20,0,10"/>
                                    <ListBox x:Name="lstRolleBenutzer" Height="100" IsEnabled="False">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock>
                                                    <Run Text="{Binding CBenutzername}"/>
                                                    <Run Text=" - " Foreground="Gray"/>
                                                    <Run Text="{Binding VollName}" Foreground="Gray"/>
                                                </TextBlock>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>

                                    <!-- Speichern -->
                                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                                        <Button Content="Speichern" Click="RolleSpeichern_Click" Padding="20,8"
                                                Background="{DynamicResource PrimaryBrush}" Foreground="White" FontWeight="SemiBold"/>
                                    </StackPanel>

                                    <TextBlock x:Name="txtRolleStatus" Text="" Foreground="Green" Margin="0,15,0,0"/>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>

            <!-- Hersteller Tab -->
            <TabItem Header="Hersteller">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Hersteller verwalten" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <DataGrid x:Name="dgHersteller" Grid.Row="1" AutoGenerateColumns="False"
                              BorderThickness="1" BorderBrush="#ddd" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Homepage" Binding="{Binding CHomepage}" Width="200"/>
                            <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="*"/>
                            <DataGridTextColumn Header="Sort." Binding="{Binding NSort}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Neu" Click="HerstellerNeu_Click" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="Speichern" Click="HerstellerSpeichern_Click" Padding="15,8" Margin="0,0,10,0"/>
                        <Button Content="Loeschen" Click="HerstellerLoeschen_Click" Padding="15,8" Foreground="#D32F2F"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Rueckgabegruende Tab -->
            <TabItem Header="Rueckgabegruende">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Rueckgabegruende fuer Retouren" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <DataGrid x:Name="dgRueckgabegruende" Grid.Row="1" AutoGenerateColumns="False"
                              BorderThickness="1" BorderBrush="#ddd" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="*"/>
                            <DataGridCheckBoxColumn Header="Aktiv" Binding="{Binding NAktiv}" Width="60"/>
                            <DataGridTextColumn Header="Farbe" Binding="{Binding CColor}" Width="80"/>
                            <DataGridTextColumn Header="Sort." Binding="{Binding NSort}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Neu" Click="RueckgabegrundNeu_Click" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="Speichern" Click="RueckgabegrundSpeichern_Click" Padding="15,8" Margin="0,0,10,0"/>
                        <Button Content="Loeschen" Click="RueckgabegrundLoeschen_Click" Padding="15,8" Foreground="#D32F2F"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Masseinheiten Tab -->
            <TabItem Header="Masseinheiten">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Masseinheiten fuer Artikel" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <DataGrid x:Name="dgMasseinheiten" Grid.Row="1" AutoGenerateColumns="False"
                              BorderThickness="1" BorderBrush="#ddd" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Code" Binding="{Binding CCode}" Width="80"/>
                            <DataGridTextColumn Header="Anzeige" Binding="{Binding CDisplayCode}" Width="80"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Neu" Click="MasseinheitNeu_Click" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="Speichern" Click="MasseinheitSpeichern_Click" Padding="15,8" Margin="0,0,10,0"/>
                        <Button Content="Loeschen" Click="MasseinheitLoeschen_Click" Padding="15,8" Foreground="#D32F2F"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Artikelzustaende Tab -->
            <TabItem Header="Artikelzustaende">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Artikelzustaende (Neu, Gebraucht, etc.)" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <DataGrid x:Name="dgArtikelzustaende" Grid.Row="1" AutoGenerateColumns="False"
                              BorderThickness="1" BorderBrush="#ddd" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="150"/>
                            <DataGridTextColumn Header="Suffix" Binding="{Binding CSuffix}" Width="80"/>
                            <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="*"/>
                            <DataGridCheckBoxColumn Header="Aktiv" Binding="{Binding NAktiv}" Width="60"/>
                            <DataGridTextColumn Header="Farbe" Binding="{Binding CColor}" Width="80"/>
                            <DataGridTextColumn Header="Sort." Binding="{Binding NSort}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Neu" Click="ArtikelzustandNeu_Click" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="Speichern" Click="ArtikelzustandSpeichern_Click" Padding="15,8" Margin="0,0,10,0"/>
                        <Button Content="Loeschen" Click="ArtikelzustandLoeschen_Click" Padding="15,8" Foreground="#D32F2F"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Attribute Tab -->
            <TabItem Header="Attribute">
                <Grid Margin="15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="220"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Attribute (JTL Shop/Marktplaetze)" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10" Grid.ColumnSpan="2"/>

                    <!-- Gruppen-Liste -->
                    <Border Grid.Row="1" Background="White" BorderBrush="#e0e0e0" BorderThickness="1" CornerRadius="4" Margin="0,0,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Text="Gruppen" FontWeight="SemiBold" Margin="10,8"/>
                            <ListBox x:Name="lstAttributGruppen" Grid.Row="1" BorderThickness="0"
                                     SelectionChanged="LstAttributGruppen_SelectionChanged">
                                <ListBox.Resources>
                                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="{DynamicResource PrimaryColor}"/>
                                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>
                                </ListBox.Resources>
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Padding" Value="10,6"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding CGruppeName}" Width="140"/>
                                            <TextBlock Text="{Binding Anzahl}" Foreground="#666" Width="30" TextAlignment="Right"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                    </Border>

                    <!-- Attribute-Grid -->
                    <DataGrid x:Name="dgAttribute" Grid.Row="1" Grid.Column="1" AutoGenerateColumns="False"
                              BorderThickness="1" BorderBrush="#ddd" CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Gruppe" Binding="{Binding CGruppeName}" Width="150"/>
                            <DataGridTextColumn Header="Beschreibung" Binding="{Binding CBeschreibung}" Width="*"/>
                            <DataGridCheckBoxColumn Header="Mehrsprachig" Binding="{Binding NIstMehrsprachig}" Width="80"/>
                            <DataGridCheckBoxColumn Header="Freifeld" Binding="{Binding NIstFreifeld}" Width="60"/>
                            <DataGridCheckBoxColumn Header="Standard" Binding="{Binding NIstStandard}" Width="60" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Sort." Binding="{Binding NSort}" Width="50"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Neu" Click="AttributNeu_Click" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="Speichern" Click="AttributSpeichern_Click" Padding="15,8" Margin="0,0,10,0"/>
                        <Button Content="Loeschen" Click="AttributLoeschen_Click" Padding="15,8" Foreground="#D32F2F"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Merkmale Tab -->
            <TabItem Header="Merkmale">
                <Grid Margin="15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="300"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Merkmale (Artikeleigenschaften)" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10" Grid.ColumnSpan="2"/>

                    <!-- Merkmale-Grid -->
                    <DataGrid x:Name="dgMerkmale" Grid.Row="1" AutoGenerateColumns="False"
                              BorderThickness="1" BorderBrush="#ddd" CanUserAddRows="False"
                              SelectionChanged="DgMerkmale_SelectionChanged" Margin="0,0,10,0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding CName}" Width="200"/>
                            <DataGridTextColumn Header="Typ" Binding="{Binding CTyp}" Width="100"/>
                            <DataGridCheckBoxColumn Header="Global" Binding="{Binding NGlobal}" Width="60"/>
                            <DataGridCheckBoxColumn Header="Mehrfach" Binding="{Binding NMehrfachauswahl}" Width="70"/>
                            <DataGridTextColumn Header="Werte" Binding="{Binding WerteAnzahl}" Width="60"/>
                            <DataGridTextColumn Header="Sort." Binding="{Binding NSort}" Width="50"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Merkmal-Werte -->
                    <Border Grid.Row="1" Grid.Column="1" Background="White" BorderBrush="#e0e0e0" BorderThickness="1" CornerRadius="4">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Text="Merkmal-Werte" FontWeight="SemiBold" Margin="10,8"/>
                            <DataGrid x:Name="dgMerkmalWerte" Grid.Row="1" AutoGenerateColumns="False"
                                      BorderThickness="0" CanUserAddRows="False" Margin="5,0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Wert" Binding="{Binding CWert}" Width="*"/>
                                    <DataGridTextColumn Header="Sort." Binding="{Binding NSort}" Width="50"/>
                                </DataGrid.Columns>
                            </DataGrid>
                            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="10,5">
                                <Button Content="+" Click="MerkmalWertNeu_Click" Padding="8,4" Width="30" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,5,0"/>
                                <Button Content="-" Click="MerkmalWertLoeschen_Click" Padding="8,4" Width="30" Foreground="#D32F2F"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Neu" Click="MerkmalNeu_Click" Padding="15,8" Background="{DynamicResource PrimaryBrush}" Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="Speichern" Click="MerkmalSpeichern_Click" Padding="15,8" Margin="0,0,10,0"/>
                        <Button Content="Loeschen" Click="MerkmalLoeschen_Click" Padding="15,8" Foreground="#D32F2F"/>
                    </StackPanel>
                </Grid>
            </TabItem>

        </TabControl>
    </Grid>
</UserControl>
